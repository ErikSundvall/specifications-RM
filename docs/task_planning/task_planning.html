<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="description" content="openEHR Task Planning Specification">
<meta name="keywords" content="task, planning, EHR, EMR, reference model, openehr">
<title>Task Planning Model Specification</title>
<link rel="stylesheet" href="http://www.openehr.org/releases/BASE/latest/resources/css/openehr.css">
<link rel="stylesheet" href="http://www.openehr.org/releases/BASE/latest/resources/css/pygments-murphy.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_task_planning_model_specification">Task Planning Model Specification</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_trademarks">Trademarks</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_conformance">1.4. Conformance</a></li>
</ul>
</li>
<li><a href="#_background">2. Background</a>
<ul class="sectlevel2">
<li><a href="#_survey_of_requirements">2.1. Survey of Requirements</a></li>
<li><a href="#_limitations_of_openehr_standard_entry_model">2.2. Limitations of openEHR standard Entry Model</a></li>
<li><a href="#_xxx">2.3. xxx</a></li>
<li><a href="#_execution_paradigm">2.4. Execution Paradigm</a></li>
<li><a href="#_relationship_to_workflow_formalisms_and_systems">2.5. Relationship to Workflow Formalisms and Systems</a></li>
</ul>
</li>
<li><a href="#_requirements">3. Requirements</a>
<ul class="sectlevel2">
<li><a href="#_planned_tasks_for_an_order">3.1. Planned Tasks for an Order</a></li>
<li><a href="#_order_sets_and_protocols">3.2. Order Sets and Protocols</a></li>
<li><a href="#_lookahead_plan">3.3. Lookahead Plan</a></li>
<li><a href="#_checklist_sign_off">3.4. Checklist &amp; Sign-off</a></li>
<li><a href="#_teamwork_and_notifications">3.5. Teamwork and Notifications</a></li>
<li><a href="#_task_grouping_optionality_and_execution_basis">3.6. Task Grouping, Optionality and Execution Basis</a></li>
<li><a href="#_decision_pathways">3.7. Decision Pathways</a></li>
<li><a href="#_changes_and_abandonment">3.8. Changes and Abandonment</a></li>
<li><a href="#_rationalising_unrelated_task_plans">3.9. Rationalising Unrelated Task Plans</a></li>
<li><a href="#_support_process_analytics">3.10. Support Process Analytics</a></li>
<li><a href="#_support_for_costing_and_billing_information">3.11. Support for Costing and Billing Information</a></li>
</ul>
</li>
<li><a href="#_design_principles">4. Design Principles</a>
<ul class="sectlevel2">
<li><a href="#_levels_of_model_definition">4.1. Levels of Model Definition</a></li>
<li><a href="#_fractal_structure">4.2. Fractal Structure</a></li>
<li><a href="#_single_subject_principal_performer">4.3. Single Subject, Principal Performer</a></li>
<li><a href="#_phases_of_work">4.4. Phases of Work</a></li>
<li><a href="#_separation_of_task_definition_and_execution_state">4.5. Separation of Task Definition and Execution State</a></li>
</ul>
</li>
<li><a href="#_task_planning_model">5. Task Planning Model</a>
<ul class="sectlevel2">
<li><a href="#_overview">5.1. Overview</a></li>
</ul>
</li>
<li><a href="#_task_definition_model">6. Task Definition Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">6.1. Overview</a>
<ul class="sectlevel3">
<li><a href="#_compositions_and_versioning">6.1.1. Compositions and Versioning</a></li>
<li><a href="#_basic_semantics_of_a_task_plan">6.1.2. Basic Semantics of a Task Plan</a></li>
<li><a href="#_compositional_structure">6.1.3. Compositional Structure</a></li>
<li><a href="#_basic_semantics_of_a_task">6.1.4. Basic Semantics of a Task</a></li>
<li><a href="#_task_plan_compositional_structure">6.1.5. Task Plan Compositional Structure</a></li>
</ul>
</li>
<li><a href="#_task_definition">6.2. Task Definition</a>
<ul class="sectlevel3">
<li><a href="#_coordinated_teamwork">6.2.1. Coordinated Teamwork</a></li>
<li><a href="#_timing">6.2.2. Timing</a></li>
<li><a href="#_pre_conditions">6.2.3. Pre-conditions</a></li>
</ul>
</li>
<li><a href="#_decision_structures">6.3. Decision Structures</a></li>
<li><a href="#_task_availability">6.4. Task Availability</a></li>
<li><a href="#_class_descriptions">6.5. Class Descriptions</a>
<ul class="sectlevel3">
<li><a href="#_task_plan_class">6.5.1. TASK_PLAN Class</a></li>
<li><a href="#_task_participation_class">6.5.2. TASK_PARTICIPATION Class</a></li>
<li><a href="#_plan_item_class">6.5.3. PLAN_ITEM Class</a></li>
<li><a href="#_task_item_class">6.5.4. TASK_ITEM Class</a></li>
<li><a href="#_timing_spec_class">6.5.5. TIMING_SPEC Class</a></li>
<li><a href="#_clock_timing_class">6.5.6. CLOCK_TIMING Class</a></li>
<li><a href="#_event_linked_timing_class">6.5.7. EVENT_LINKED_TIMING Class</a></li>
<li><a href="#_temporal_relation_enumeration">6.5.8. TEMPORAL_RELATION Enumeration</a></li>
<li><a href="#_task_linked_timing_class">6.5.9. TASK_LINKED_TIMING Class</a></li>
<li><a href="#_timing_reference_enumeration">6.5.10. TIMING_REFERENCE Enumeration</a></li>
<li><a href="#_task_group_class">6.5.11. TASK_GROUP Class</a></li>
<li><a href="#_decision_group_class">6.5.12. DECISION_GROUP Class</a></li>
<li><a href="#_decision_path_group_class">6.5.13. DECISION_PATH_GROUP Class</a></li>
<li><a href="#_execution_type_enumeration">6.5.14. EXECUTION_TYPE Enumeration</a></li>
<li><a href="#_task_class">6.5.15. TASK Class</a></li>
<li><a href="#_external_plan_class">6.5.16. EXTERNAL_PLAN Class</a></li>
<li><a href="#_defined_task_class">6.5.17. DEFINED_TASK Class</a></li>
<li><a href="#_task_notification_class">6.5.18. TASK_NOTIFICATION Class</a></li>
<li><a href="#_task_precondition_class">6.5.19. TASK_PRECONDITION Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_task_execution_model">7. Task Execution Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">7.1. Overview</a></li>
<li><a href="#_task_plan_execution_tracking">7.2. Task Plan Execution Tracking</a>
<ul class="sectlevel3">
<li><a href="#_task_plan_instantiation">7.2.1. Task Plan Instantiation</a></li>
<li><a href="#_allocation">7.2.2. Allocation</a></li>
<li><a href="#_task_lifecycle_model">7.2.3. Task Lifecycle Model</a></li>
<li><a href="#_notifications">7.2.4. Notifications</a></li>
<li><a href="#_persistence">7.2.5. Persistence</a></li>
<li><a href="#_class_descriptions_2">7.2.6. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_lifecycle_enumeration">7.2.6.1. TASK_LIFECYCLE Enumeration</a></li>
<li><a href="#_rt_task_plan_class">7.2.6.2. RT_TASK_PLAN Class</a></li>
<li><a href="#_rt_wait_conditions_class">7.2.6.3. RT_WAIT_CONDITIONS Class</a></li>
<li><a href="#_rt_plan_item_class">7.2.6.4. RT_PLAN_ITEM Class</a></li>
<li><a href="#_rt_task_item_class">7.2.6.5. RT_TASK_ITEM Class</a></li>
<li><a href="#_rt_decision_group_class">7.2.6.6. RT_DECISION_GROUP Class</a></li>
<li><a href="#_rt_task_group_class">7.2.6.7. RT_TASK_GROUP Class</a></li>
<li><a href="#_rt_task_class">7.2.6.8. RT_TASK Class</a></li>
<li><a href="#_rt_decision_path_group_class">7.2.6.9. RT_DECISION_PATH_GROUP Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_task_plan_execution_history">7.3. Task Plan Execution History</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_3">7.3.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_plan_execution_history_class">7.3.1.1. TASK_PLAN_EXECUTION_HISTORY Class</a></li>
<li><a href="#_event_record_class">7.3.1.2. EVENT_RECORD Class</a></li>
<li><a href="#_task_plan_event_record_class">7.3.1.3. TASK_PLAN_EVENT_RECORD Class</a></li>
<li><a href="#_task_event_record_class">7.3.1.4. TASK_EVENT_RECORD Class</a></li>
<li><a href="#_task_notification_record_class">7.3.1.5. TASK_NOTIFICATION_RECORD Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_cost_tracking">7.4. Cost Tracking</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_4">7.4.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_costing_class">7.4.1.1. TASK_COSTING Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_transactional_micro_service">7.5. Transactional Micro-service</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_5">7.5.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_planning_ms_interface">7.5.1.1. TASK_PLANNING_MS Interface</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_relationship_with_other_openehr_ehr_artefacts">8. Relationship with other openEHR EHR Artefacts</a>
<ul class="sectlevel2">
<li><a href="#_principles">8.1. Principles</a></li>
<li><a href="#_execution_time_ehr_structures">8.2. Execution-time EHR Structures</a></li>
</ul>
</li>
<li><a href="#_scenarios">9. Scenarios</a>
<ul class="sectlevel2">
<li><a href="#_protocol_driven_plan">9.1. Protocol-driven Plan</a></li>
<li><a href="#_check_list_and_sign_off">9.2. Check-list and Sign-off</a></li>
<li><a href="#_changes_during_execution">9.3. Changes during Execution</a></li>
<li><a href="#_abandonment">9.4. Abandonment</a></li>
</ul>
</li>
<li><a href="#_implementation_guidance">10. Implementation Guidance</a>
<ul class="sectlevel2">
<li><a href="#_workflow_application_design">10.1. Workflow Application Design</a></li>
<li><a href="#_versioning">10.2. Versioning</a></li>
</ul>
</li>
<li><a href="#_references">References</a>
<ul class="sectlevel2">
<li><a href="#_publications">Publications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="http://www.openehr.org/releases/BASE/latest/resources/images/openehr_logo_large.png" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_task_planning_model_specification" class="sect0">Task Planning Model Specification</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="http://www.openehr.org/programs/specification/">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: DEVELOPMENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: task, planning, EHR, EMR, reference model, openehr</p></td>
</tr>
</tbody>
</table>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="diagrams/openehr_block_diagram.png" alt="openEHR components" width="60%">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2017 - 2017 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="http://www.openehr.org/">The openEHR Foundation</a> is an independent, non-profit community organisation, facilitating the sharing of health records by consumers and clinicians via open-source, standards-based implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="http://www.openehr.org/releases/BASE/latest/resources/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://openehr.atlassian.net/browse/SPECPR/" class="bare">https://openehr.atlassian.net/browse/SPECPR/</a><br>
 Web: <a href="http://www.openehr.org/" class="bare">http://www.openehr.org/</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record">Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>R E L E A S E&#160;&#160;&#160;&#160;&#160;1.?.?</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>0.7.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incorporate review comments from Boštjan Lah.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Lah,
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>20 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rework runtime model.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">07 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incorporate review comments from Pablo Pazos.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">06 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Major rewrite, incorporating structure, parallelism, decision paths, and execution history.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31 May 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openehr.atlassian.net/browse/SPECRM-58">SPECRM-58</a>. Initial writing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,
 B Naess,
 I McNicoll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">26 Jan 2017</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements">Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The work reported in this paper has been funded by the following organisations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DIPS, Norway</p>
</li>
<li>
<p>Marand d.o.o., Slovenia</p>
</li>
<li>
<p>Ars Semantica, UK</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_trademarks">Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'openEHR' is a trademark of the openEHR Foundation</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document describes the openEHR Task Planning Model, which is a formal specification of information representing Planned Tasks. It is designed as a formal extension to the openEHR EHR Information Model, and assumes the types described in that specification.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Academic groups using openEHR;</p>
</li>
<li>
<p>The open source healthcare community;</p>
</li>
<li>
<p>Solution vendors;</p>
</li>
<li>
<p>Medical informaticians and clinicians interested in health information.</p>
</li>
<li>
<p>Health data managers.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="http://www.openehr.org/releases/BASE/latest/architecture_overview.html">openEHR Architecture Overview</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Related documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="http://www.openehr.org/releases/RM/latest/ehr.html">openEHR EHR Information Model</a>;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the DEVELOPMENT state. The development version of this document can be found at <a href="http://www.openehr.org/releases/RM/latest/task_planning.html" class="bare">http://www.openehr.org/releases/RM/latest/task_planning.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
<div class="paragraph">
<p>Users are encouraged to comment on and/or advise on these paragraphs as well as the main content.  Feedback should be provided either on the <a href="http://lists.openehr.org/mailman/listinfo/openehr-technical_lists.openehr.org">technical mailing list</a>, or on the <a href="https://openehr.atlassian.net/browse/SPECPR/?selectedTab=com.atlassian.jira.jira-projects-plugin:issues-panel">specifications issue tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.4. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR Reference Model specification is determined by a formal test of that artifact against the relevant openEHR Implementation Technology Specification(s) (ITSs), such as an IDL interface or an XML-schema. Since ITSs are formal, automated derivations from the Reference Model, ITS conformance indicates RM conformance.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_background"><a class="anchor" href="#_background"></a>2. Background</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_survey_of_requirements"><a class="anchor" href="#_survey_of_requirements"></a>2.1. Survey of Requirements</h3>
<div class="paragraph">
<p>This specification for a Task Planning facility for openEHR addresses requirements in a number of areas in which some form of 'planning' of clinical work is required. The defining characteristic of the requirements is that they primarily relate to an active human subject, rather than a passive object, such as a parcel or tissue sample. The requirements covered include one-off scheduled tasks (e.g. surgical procedure), long-running scheduled tasks (e.g. drug administration), recurring tasks (e.g. monitoring), and coordinated teamwork (e.g. acute stroke management).</p>
</div>
<div class="paragraph">
<p>The specification also addresses the lack of fine-grained task planning facilities in the basic openEHR specifications, which are limited to the Instruction and Action concepts. These provide ways of stating orders and recording actions performed after the fact, but no way of representing or sharing plans for actions before they are performed. This limitation is described in more detail below.</p>
</div>
<div class="paragraph">
<p>The general approach followed here is to specify a representation of task plans at various stages in the planning lifecycle, i.e.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>design time</strong>: templates or prototypes of standard task plans are developed and published;</p>
</li>
<li>
<p><strong>runtime - planning</strong>: task plan prototypes are turned into concrete plans for specific work items for specific patients and activated;</p>
</li>
<li>
<p><strong>runtime - work execution</strong>: task plans are executed by clinical performers and the plan maintained up to date in real time;</p>
</li>
<li>
<p><strong>runtime - work completion</strong>: as each task is performed, standard clinical statements (openEHR Entries) are committed to the EHR to record what was done.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The models described here are thus designed to support both design-time modelling (via archetypes, terminology subsetting) and runtime execution with modifications and abandonment possible while the work is being performed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_limitations_of_openehr_standard_entry_model"><a class="anchor" href="#_limitations_of_openehr_standard_entry_model"></a>2.2. Limitations of openEHR standard Entry Model</h3>
<div class="paragraph">
<p>The Entry model described in the <a href="http://www.openehr.org/releases/RM/latest/ehr.html">openEHR EHR IM</a> defines a way to record clinical statements representing real observations, decisions, orders and actions that have occurred, in the EHR. In this scheme, Instructions represent orders for certain kinds of Actions to be performed. Actions and Observations represent events that have subsequently occurred in the real world - a real drug administration or an actual blood sugar measurement.</p>
</div>
<div class="paragraph">
<p>There is however a common additional need to concretely plan individual Actions and sometimes Observations ahead of time, as a set of 'tasks', often known as a 'task list'. Here we will use the more general term <em>task plan</em> to mean a specification of a set of actions to be performed by actors (usually human, but potentially machine as well) providing care.</p>
</div>
<div class="paragraph">
<p>A set of planned tasks need not all relate to a single order, or indeed any order. The general picture is that a task plan corresponds to some self-standing healthcare job to be done, which may include tasks designed to fulfill multiple orders, and also tasks not defined by orders.</p>
</div>
<div class="paragraph">
<p>To meet this need, a further kind of content can be recorded in the EHR, representing task plans containing tasks. Here we understand the word 'task' to mean 'definition of a planned task', i.e. a description of something to be performed in the future.</p>
</div>
</div>
<div class="sect2">
<h3 id="_xxx"><a class="anchor" href="#_xxx"></a>2.3. xxx</h3>
<div class="paragraph">
<p>In order to respond to the need to formally represent clinical Task Plans, and to close the gap between orders and reported actions in openEHR, this specification provides a model of a <em>task planning</em> facility, which is conceptually situated in a larger semantic framework that includes entities at multiple levels, i.e.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>care pathway - a model of a guideline for care of a condition / ideal patient;</p>
</li>
<li>
<p>care plan - a general plan for care of an actual patient, taking into account zero or more Care Pathways and individual specificities;</p>
</li>
<li>
<p>task plan - a concrete concept that defines a set of fine-grained planned tasks to perform over time to achieve a particular goal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These entities and their relationships can be envisaged as follows.</p>
</div>
<div id="pathway_plan_triad" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/pathway_plan_triad.svg" alt="pathway plan triad" width="60%">
</div>
<div class="title">Figure 1. The care pathway / care plan / task plan triad</div>
</div>
<div class="paragraph">
<p>The above diagram shows task plans as a concrete planning artefact that results from a care plan for a specific patient, and may be partly based on published care pathways or clinical guidelines, each of which can be thought of as a basis for task plans for an ideal patient for a given condition (e.g. pregnancy, sepsis, stroke etc). Where care pathways (or parts thereof) can be represented as formal artefacts, they can act as prototypes for task pan structures. However, a care pathway for a model patient is not the same thing as a task plan(s) for an actual patient, since each real patient has his/her own specific combination of conditions, preferences and ultimately phenotypic specificities. Thus, where task plans are based on care pathways, the latter act as prototypes whose ideal form may be modified by the specific care plan and/or as the care team deems appropriate.</p>
</div>
<div class="paragraph">
<p>The model described here addresses the representation and semantics of concrete task plans. It does not address the representation of the care plan and it does not say anything directly about formal care pathway representation, although it may be surmised for the future that the formal form of a care pathway may have significant commonality with the task plan model presented here, which may provide a useful guide for future work in care pathway representation.</p>
</div>
<div class="paragraph">
<p>The task plan model does however assume that a task plan may be <em>created</em> due to a care plan of some kind, and that the care plan may in turn have been derived from one or more care pathways or guidelines; accordingly, the means to identify the plan and pathway / guideline are provided.</p>
</div>
<div class="paragraph">
<p>In the following, the term 'task' denotes the definition of an action to be performed, the report of which is normally documented in openEHR by the <code>ACTION</code> Entry subtype. However, 'task' is also understood more generally, so that it may also when performed, result in an openEHR <code>OBSERVATION</code> or other Entry subtype where appropriate. In the great majority of cases therefore, the term 'task' as it appears here equates to openEHR Actions and Observations.</p>
</div>
<div class="paragraph">
<p>For the sake of brevity, 'Action' below is intended to imply an openEHR <code>ACTION</code>, <code>OBSERVATION</code> or potentially other Entry sub-type, unless otherwise stated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_paradigm"><a class="anchor" href="#_execution_paradigm"></a>2.4. Execution Paradigm</h3>
<div class="paragraph">
<p>As soon as the notion of 'planning' is assumed, we enter some form of the workflow space, and it becomes essential to describe the intended paradigm of the human / machine execution environment. This is due to the fact that any description of planned tasks acts as a set of instructions to actors intended to perform the tasks. Since the instructions (task plans) will be represented in the IT layer and the executing actors (generally human, although they may also be devices or software applications) exist in the real world, an account of the interaction between the computing environment and the real world is required.</p>
</div>
<div class="paragraph">
<p>Although the task plan facility described in this specification is relatively simple compared to some workflow tools, we can nevertheless distinguish the following entities in the environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>computing environment</em>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>work plan definition</strong>: a reusable definition of work to be done, consisting of tasks, potentially standardised according to a guideline or protocol;</p>
</li>
<li>
<p><strong>work plan instance</strong>: a run-time instance of a task plan, potentially with local variations, created for execution by an actor or actors;</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>real world</em>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>performing actor</strong>, i.e. a human, machine or software application that performs tasks in the real world as part of a procedure designed to achieve a goal;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In normal environments such as healthcare, the real-world actors are not passive recipients of commands from a computer application implementing a work plan, but are instead active agents who normally work together to perform a job. Working together involves peer to peer communication, ordering of tasks and so on. A workflow application provides help by maintaining a representation of the work plan, and a representation of its progress in execution. It is immediately apparent that the application&#8217;s idea of a given work plan execution and the real world state of the same work are not identical, and in fact may be only approximately related. For example, the computable form of the work plan might only include some of the tasks and actors at work in the real world. There are in fact two workflows executing: a virtual workflow and the real world one, and there is accordingly a problem of <em>synchronisation</em> of the two.</p>
</div>
<div class="paragraph">
<p>There is also a question of communication between the workflow application and the real world actors, which we can think of as consisting of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>commands</strong>: signals from the work plan system to a real world actor to do something;</p>
</li>
<li>
<p><strong>notifications</strong>: signals to and from the work plan system and the real world actors on the status of work, e.g. 'new work item', 'item completed' etc;</p>
</li>
<li>
<p><strong>data</strong>: data collection from actors and presentation to actors from the system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This environment can be illustrated as follows.</p>
</div>
<div id="workflow_execution_paradigm" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/workflow_execution_paradigm.svg" alt="workflow execution paradigm" width="55%">
</div>
<div class="title">Figure 2. Work plan execution paradigm</div>
</div>
</div>
<div class="sect2">
<h3 id="_relationship_to_workflow_formalisms_and_systems"><a class="anchor" href="#_relationship_to_workflow_formalisms_and_systems"></a>2.5. Relationship to Workflow Formalisms and Systems</h3>
<div class="paragraph">
<p>This specification describes a model for a 'task plan' concept that incudes support for work distribution across multiple performers, nested task plans, conditional branching, timing and various other facilities. Many of these are conceptually close to the features found in standard workflow languages such as <a href="http://www.bpmn.org/">BPMN</a> (Business Process Modelling Notation) and <a href="http://yawlfoundation.org/">YAWL</a> (Yet another Workflow Language), as well as emerging case-based standards such as <a href="http://www.omg.org/spec/CMMN/1.0/">CMMN</a> (Case Management Modelling Notation) and <a href="http://www.omg.org/spec/DMN/">DMN</a> (Decision Model and Notation).</p>
</div>
<div class="paragraph">
<p>While the model described here takes many ideas from these languauges, there are some key differencs as well. The primary conceptual difference is that the subject (i.e. 'case') here is assumed to be an intentional organism (generally a human patient) that makes choices, reacts to drugs, and generally speaking, cannot be relied on to be a passive object (such as a package or blood sample), as is the case for most logistic workflows, for which languages such as BPMN are suited.</p>
</div>
<div class="paragraph">
<p>The main consequence of this is that the design of a task plan is not taken to be a highly deterministic description whose exceptions are generally knowable in advance as they would be for a logistic system whose subjects are passive objects. Instead, tasks and groups of tightly-coupled tasks are specified in a more self-standing way, using preconditions rather than logical join and split operators. Note that even the patient can be a passive object in some circumstances, such as radiology.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_requirements"><a class="anchor" href="#_requirements"></a>3. Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Task planning is applicable to numerous clinical scenarios, exemplified by the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>routine simple medication administration, e.g. for post-operative pain - tasks extend across worker shifts;</p>
</li>
<li>
<p>complex drug administration e.g. multi-drug chemotherapy over multiple days;</p>
</li>
<li>
<p>physiotherapy rehabilitation sessions - recurrent therapeutic procedure, with defined end-point;</p>
</li>
<li>
<p>dialysis - recurrent therapeutic procedure;</p>
</li>
<li>
<p>diet + physical activity plan for overweight treatment - recurrent tasks, patient as a performer;</p>
</li>
<li>
<p>surgery planning - one time event;</p>
</li>
<li>
<p>acute stroke management - multiple sets of tasks coordinated across multiple performers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Within these and many other similar clinical procedures, a number of commonly occurring generic requirements appear, as described below.</p>
</div>
<div class="sect2">
<h3 id="_planned_tasks_for_an_order"><a class="anchor" href="#_planned_tasks_for_an_order"></a>3.1. Planned Tasks for an Order</h3>
<div class="paragraph">
<p>The simplest need is to be able to post a full plan of all actions to be performed for an order, in advance of the order commencing. This would result in a series of Tasks for each planned openEHR <code>ACTION</code> at execution time.</p>
</div>
<div class="paragraph">
<p>In openEHR, an order is represented by an <code>INSTRUCTION</code> instance, which contains a directive to do something such as preform radiography or administer medication. The form of representation in the Instruction is normally <em>interpretable</em> by an agent who will convert it to separate tasks. For example, a drug order for Amoxicillin 500mg oral tablet 3 times/day x 7 days is converted by a human agent to 21 separate tasks, each consisting of taking one tablet at a certain time or day. These tasks can be represented in a task plan, each task of which which can then be performed and signed off by a staff member, e.g. a shift nurse. The task plan acts as a record of what has been done, and what is left to do.</p>
</div>
<div class="paragraph">
<p>One difficulty with posting a full plan is that in some cases, the work is effectively open-ended, i.e. it has no currently known completion date. This might be because the patient condition being treated is chronic, e.g. insulin or Salbutamol (Ventolin) treatment; or it might be that although the condition is assumed to be limited in time, no current assumption can be made about when, e.g. pain medication of a trauma patient.</p>
</div>
</div>
<div class="sect2">
<h3 id="_order_sets_and_protocols"><a class="anchor" href="#_order_sets_and_protocols"></a>3.2. Order Sets and Protocols</h3>
<div class="paragraph">
<p>A plan for a clinical intervention will typically need to encompass more than one order, in situations where drugs and other therapies are used according to a protocol or regime. For example, in multi-drug chemotherapy based on protocols like CHOP (non-Hodgkin&#8217;s lymphoma), COPP or Stanford V (Hodgkin&#8217;s lymphoma) etc, a single drug such as Cyclophosphamide is just a component. A task plan for administering chemotherapy according to a R-CHOP protocol would implicate orders for the drugs  (R)ituximab, (C)yclophosphamide, (H)ydroxydaunorubicin, (O)ncovin, and (P)rednisolone or Prednisone, and would accordingly include planned tasks for each of these drugs as they are administered according to the protocol.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Drug</th>
<th class="tableblock halign-left valign-top">Standard [R]-CHOP-14 or<br>
 [R]-CHOP-21</th>
<th class="tableblock halign-left valign-top">[R]-Maxi-CHOP</th>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">Days</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(R)ituximab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">375 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">375 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV infusion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(C)yclophosphamide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">750 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1200 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV infusion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(H)ydroxydaunorubicin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV bolus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(O)ncovin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4 mg/m² (max. 2 mg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 mg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV bolus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(P)rednisone or (P)rednisolone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 mg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PO qd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Days 1-5</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>(Extract from <a href="https://en.wikipedia.org/wiki/CHOP">Wikipedia</a>.)</p>
</div>
<div class="paragraph">
<p>A more general notion is of a protocol or guideline, which is a full set of actions to be performed to achieve a goal. Some of the actions will have corresponding orders, but others, such as making intermediate observations, may not. Examples can be found at sites such as the <a href="https://pathways.nice.org.uk/">UK National Institute for Care and Excellence (NICE)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lookahead_plan"><a class="anchor" href="#_lookahead_plan"></a>3.3. Lookahead Plan</h3>
<div class="paragraph">
<p>A more flexible version of a plan is 'lookahead' planning, i.e. posting a plan of tasks for a moving window in time, e.g. one day, a few days, a few nursing rotations etc. The idea is not to try to plan out the entire plan execution, since it can easily change or be stopped, e.g. due to change in patient or other unexpected events. In a lookahead approach, some planned tasks are executed, and more planned tasks are added. The planned timing of each set of tasks may change due to the current situation, with the effect that the overall set of tasks that unfolds in time may well be different from an attempt to plan all tasks before any are executed.</p>
</div>
<div class="paragraph">
<p>For the open-ended cases mentioned above, the only option is a lookahead plan that extends as far ahead in time as the treating physicians are prepared to go.</p>
</div>
</div>
<div class="sect2">
<h3 id="_checklist_sign_off"><a class="anchor" href="#_checklist_sign_off"></a>3.4. Checklist &amp; Sign-off</h3>
<div class="paragraph">
<p>If a task plan is created, the constituent tasks can be viewed by workers as a checklist, and subsequently signed off as having been either performed or not done over time. The utility of this is that the correspondence between the tasks actually performed (represented by <code>ACTION</code>, <code>OBSERVATION</code> etc Entries) and the planned tasks is established. If a planned Action A1 is posted with execution time T, it might actually be performed at time T', but users still want to know that it was planned Action A1 that was intentionally performed, and not some other Action in the task plan. Over the course of the order execution, a picture will emerge of planned Actions being performed and signed off, possibly with some being missed as not needed, or not done for some other reason. Additional Actions not originally posted in the plan might also be done if they are allowed by the general specification of the relevant archetypes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_teamwork_and_notifications"><a class="anchor" href="#_teamwork_and_notifications"></a>3.5. Teamwork and Notifications</h3>
<div class="paragraph">
<p>There are at least two possible situations in which a task plan might need to refer to another task plan. The first is a consequence of the standard problem of the fractal nature of description of phenomena. Applied to planned actions, it is clear that one institution may describe an action such as cannulation atomically, relying on professional training and situational specifics to generate the correct concrete outcome, whereas another may require nurses to follow a guideline such as this <a href="http://emedicine.medscape.com/article/1998177-overview">Medscape Intravenous Cannulation</a> guideline. In cases where a self-standing clinical task is itself fully described in terms of steps, it is possible to represent the latter as its own task plan, and to be able to <em>refer</em> to it from another task plan. The general case is that any task that could be represented by a single item in a task plan could also be represented by a reference to a separate detailed task plan.</p>
</div>
<div class="paragraph">
<p>A second situation in which a task plan might refer to another is where a team of actors performs the work, and each task plan corresponds to a single actor. A typical example is acute stroke management, in which various healthcare professionals do the work. Coordination occurs when some workers inform other(s) of task completion, and/or wait for notification of completion of someone else&#8217;s task.</p>
</div>
<div class="paragraph">
<p>We can summarise these requirements as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>drill-down reuse</em>: a task plan for a given actor can refer to another self-standing task plan for the same or a different actor;</p>
</li>
<li>
<p><em>notify completion</em>: it should be possble for completion to be notified for tasks in a task plan; where applicable the system should be able to generate notifications to other workers as required by a more general coordinated care plan describing a team-based procedure;</p>
</li>
<li>
<p><em>wait for completion</em>: a task plan should be able to include a task that stands for awaiting notification of completion of another task by another actor.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_task_grouping_optionality_and_execution_basis"><a class="anchor" href="#_task_grouping_optionality_and_execution_basis"></a>3.6. Task Grouping, Optionality and Execution Basis</h3>
<div class="paragraph">
<p>A set of tasks intended to achieve a defined goal could be performed sequentially or in parallel, and may include sub-groups of tasks that can performed together. A common situation is to have a task plan intended for sequential (i.e. ordered) execution by the agent, one of whose steps is actually a sub-group of tasks which can be executed in parallel (i.e. in any order).</p>
</div>
<div class="paragraph">
<p>It can also be assumed that some tasks in a task plan may be designated as optional, to be executed 'if needed' or on some other condition being true.</p>
</div>
<div class="paragraph">
<p>The general structure and execution semantics of a task plan therefore includes the notion of sequential or parallel execution of groups of tasks, and also optional execution of some tasks. We can consider the task plan itself as a outer group of tasks for which either sequential or parallel execution can be specified.</p>
</div>
</div>
<div class="sect2">
<h3 id="_decision_pathways"><a class="anchor" href="#_decision_pathways"></a>3.7. Decision Pathways</h3>
<div class="paragraph">
<p>Task plans derived from semi-formal care pathways or guidelines (and potentially ad hoc designed plans) may contain 'decision points', which are of the following logical form:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>decision point</strong>: a step containing a variable assignment of the form <code>$v := expression</code>;</p>
</li>
<li>
<p><strong>subordinate decision paths</strong>: groups of tasks each group of which has attached a variable test of the form <code>$v rel_op value</code>, where <code>rel_op</code> is one of <code>=</code>, <code>/=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code> or <code>&gt;=</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example of decision points is shown below, in an extract from the <a href="https://intermountainhealthcare.org/ext/Dcmnt?ncid=520500199">Intermountain Healthcare Care Process Module (CPM) for Ischemic Stroke Management</a>:</p>
</div>
<div id="decision_pathway_example" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/IHC_stroke_decision_path.png" alt="IHC stroke decision path" width="80%">
</div>
<div class="title">Figure 3. Decision pathway example (Intermountain Healthcare Acute Stroke CPM)</div>
</div>
<div class="paragraph">
<p>In this example, the node containing the text "Further CLASSIFY &#8230;&#8203;" corresponds to a decision point that can be represented as <code>$symptom_onset_time := t</code>, where <code>t</code> is a time entered by a user. The subsequent nodes in the chart can be understood as paths based respectively on the tests <code>$symptom_onset_time &lt; 4.5h</code> and <code>4.5h &lt; $symptom_onset_time &lt; 6h</code>.</p>
</div>
<div class="paragraph">
<p>The ability to include decision pathways enables conditional sections of care pathways to be directly represented within a task plan.</p>
</div>
</div>
<div class="sect2">
<h3 id="_changes_and_abandonment"><a class="anchor" href="#_changes_and_abandonment"></a>3.8. Changes and Abandonment</h3>
<div class="paragraph">
<p>Inevitably, some task plans will have to be changed or abandoned partway through due to unexpected changes in the patient situation. The question here is: what should be done with the remaining planned tasks that will not be performed? Should they be marked as 'won&#8217;t do' (with some reason) and committed to the EHR, or should they be deleted prior to being committed to the EHR?</p>
</div>
<div class="paragraph">
<p>It is assumed that the answer will differ according to circumstance and local preference, in other words, that planned tasks that are created are not necessarily written into the EHR, but may initially exist in a separate 'planned tasks' buffer, and are only committed when each task is either performed or explicitly marked as not done, or else included in a list of not-done Actions to be committed to the EHR at a point of plan abandonment.</p>
</div>
<div class="paragraph">
<p>The following kinds of abandonment of tasks should be supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cancellation of an entire task plan that has been posted to the EHR or a 'planning buffer' if one exists;</p>
</li>
<li>
<p>cancellation of a particular task on a list ahead of time, with a reason;</p>
</li>
<li>
<p>marking a task as 'did not perform' after the planned time has passed, with a reason.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rationalising_unrelated_task_plans"><a class="anchor" href="#_rationalising_unrelated_task_plans"></a>3.9. Rationalising Unrelated Task Plans</h3>
<div class="paragraph">
<p>It is assumed that at any moment there could be multiple task plans extant for <em>different problems and timelines</em> for the same subject of care, e.g. chemotherapy, hypertension, ante-natal care. If naively created, these could clash in time and potentially in terms of other resources. There should therefore be support for being able to efficiently locate all existing task plans and scan their times, states and resources. This aids avoiding clashes and also finding opportunities for rationalising and bundling tasks e.g. grouping multiple tasks into a single visit, taking bloods require by two protocols at the same sitting etc.</p>
</div>
<div class="paragraph">
<p>It should be possible to process multiple task plans as part of interfacing with or constructing a 'patient diary', i.e. rationalised list of all work to be done involving the patient.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_process_analytics"><a class="anchor" href="#_support_process_analytics"></a>3.10. Support Process Analytics</h3>
<div class="paragraph">
<p>As tasks are performed and signed off on the list of posted planned tasks, there will generally be differences between Actions actually performed and the tasks on the list. Differences may include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>time of execution - this will almost always be different, even if only by seconds;</p>
</li>
<li>
<p>performer - a task intended to be performed by a specific type of actor (say a nurse) might be performed by another (say the consultant);</p>
</li>
<li>
<p>any other modifiable detail of the order, e.g. medication dose in bedside care situations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These differences are obtainable from the EHR since both planned tasks and performed Actions will appear, providing a data resource for analysing business process, order compliance, reasons for deviation and so on.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_for_costing_and_billing_information"><a class="anchor" href="#_support_for_costing_and_billing_information"></a>3.11. Support for Costing and Billing Information</h3>
<div class="paragraph">
<p>It should be possible to record internal costing data against task plans as a whole, and also individual tasks. Additionally, it should be possible to attach external billing information to tasks and task plans. Costing information might be attached to each task, such as consumption of inventory items, time and other resources. Billing information is typically more coarse-grained and reported using nationally agreed code systems, e.g. ICD10 or similar.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_principles"><a class="anchor" href="#_design_principles"></a>4. Design Principles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The design approach adopted here is based on a number of ideas. Firstly, it addresses only the 'Task Plan' level of the three conceptual levels mentioned earlier, leaving Care Plan and Care Pathway (guideline) to be addressed elsewhere. The other design elements are described below.</p>
</div>
<div class="sect2">
<h3 id="_levels_of_model_definition"><a class="anchor" href="#_levels_of_model_definition"></a>4.1. Levels of Model Definition</h3>
<div class="paragraph">
<p>In common with typical workflow systems, this specification recognises three levels of planned task model, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>templated definition</em>: a Task Plan template is a definition of a Task Plan that may be used in multiple situations, where local modifications may be made; it is represented in the form of openEHR templated archetype(s);</p>
</li>
<li>
<p><em>specific definition</em>: when a Task Plan templated archetype is instantiated, the result is understood as the <em>definition</em> of the Task Plan to be used in a specific circumstance; any modifications allowed by the archetypes may be made to achieve the specific Task Plan needed;</p>
</li>
<li>
<p><em>runtime instantiation</em>: at execution time, a Task Plan definition will be wholly or partly instantiated, along with execution state specific to the 'run', i.e. the session during which some or all of the Task Plan might be performed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this scheme, archetypes and templates conveniently achieve the 'template' or 'prototype' level of definition that is needed to support standard models of similar but not identical kinds of Task Plan. For example, a single set of archetypes and templates could be used to represent Task Plans for hospital drug administration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fractal_structure"><a class="anchor" href="#_fractal_structure"></a>4.2. Fractal Structure</h3>
<div class="paragraph">
<p>In the real world, almost every Task can be sub-divided into a smaller set of Tasks. In addition, some sets of Tasks can be performed without regard to order - i.e. in parallel - while others must be ordered. This specification accordingly supports this hierarchical structure via three structural artefacts, namely Task Plan, Task Group and Task. These follow naturally from the requirements above, but we need to articulate the semantics of these concepts, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Task</strong>: a small, separately performable unit of planned work that typically corresponds to:</p>
<div class="ulist">
<ul>
<li>
<p>the finest level of clinical responsibility, e.g. nurse administration of a drug, single observation of patient vital sign etc;</p>
</li>
<li>
<p>the finest level of re-imbursement / billing;</p>
</li>
<li>
<p>granularity of check-list and protocol single items, designed to be signed off as performed;</p>
</li>
<li>
<p>a particular planned time of execution;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Task Group</strong>: a group of Tasks within a Task Plan that are to be executed on some basis, e.g. sequential, parallel;</p>
</li>
<li>
<p><strong>Task Plan</strong>: a logical list of Tasks whose execution is intended to achieve completion of a coarse-grained task or goal with respect to a particular subject of care, typically an intervention such as a course of medication or other therapy. May contain Task Groups.</p>
<div class="ulist">
<ul>
<li>
<p>Any Task Group or Task may be marked as optional or mandatory for execution.</p>
</li>
<li>
<p>Since a Task Plan is intended to achieve a purpose, it is assumed to have a <em>lifecycle</em> whose states indicate where its execution is with respect to the outcome. See below for a full explanation of the Task Plan lifecycle.</p>
</li>
<li>
<p>It is assumed that any number of Task Plans could be active for a given subject of care at a given moment.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The consequence of the above is that a Task Plan is in general a hierarchical structure consisting of Task Group nodes and Task leaves. This enables grouping of particular Task subsets, and also the fine-grained specification of execution ordering.</p>
</div>
</div>
<div class="sect2">
<h3 id="_single_subject_principal_performer"><a class="anchor" href="#_single_subject_principal_performer"></a>4.3. Single Subject, Principal Performer</h3>
<div class="paragraph">
<p>A key design assumption is that a Task Plan is targetted at <em>single subject</em> and allocated to a <em>principle performer</em>, that is to say, a single logical actor. This is often a single person (or a device or possibly a software service, e.g. a CDS model of which questions can be asked), but might equally be a group of personnel, e.g. ward nurses, who execute the steps of a Task Plan during and across shift boundaries (wound dressing, turning patients, IV maintenance etc). In these cases there is an understanding by separate individuals that they constitute a common workforce with respect to the subject of care, for any given planned piece of work.</p>
</div>
<div class="paragraph">
<p>The principal performer can accordingly be specified in terms of a professional role, and optionally a specific agent. This might even in some cases be the patient.</p>
</div>
<div class="paragraph">
<p>In addition to the principal performer, other participations can be specified for the Task Plan or any contained step. However it is assumed that the principal performer is <em>responsible</em> for all actions, and is also the notifier of action completions and cancellations, as well as the target of notifications to do with linked Task Plans.</p>
</div>
<div class="paragraph">
<p>The consequences of this design principle are twofold:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>where a team of executing actors is required to perform a logical clinical procedure, <em>each distinct actor has his or her own Task Plan</em>;</p>
</li>
<li>
<p>for a team to operate together, coordination is required between the Task Plans and relevant actors. This is described below in more detail.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_phases_of_work"><a class="anchor" href="#_phases_of_work"></a>4.4. Phases of Work</h3>
<div class="paragraph">
<p>This design uses the notion of three potential phases of clinical work, namely 'ordering', 'planning', and 'performing'. Orders are a common way to generate tasks, but are not the only way, and many tasks are generated from a protocol or guideline or <em>ad hoc</em>. Corresponding to these phases, there are three possible levels of representation, the first and last of which already exist in the basic openEHR <code>ENTRY</code> model, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Order</strong>: statement of an order, if one exists, expressed in a <em>formulaic</em> way, e.g. corresponding to "Amoxicillin 3 times a day, orally, for 7 days";</p>
<div class="ulist">
<ul>
<li>
<p>represented in openEHR with the <code>INSTRUCTION</code> type;</p>
</li>
<li>
<p>statement of order-related actions to be performed in the future, usually expressed in a compressed algorithmic way that requires further interpretation by the performing agent to determine when individual actions occur and their details;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Planned task</strong>: representation of a single executable task in the order, to be performed in the future e.g. 'give 1 Amoxycillin oral tab at lunch';</p>
<div class="ulist">
<ul>
<li>
<p>statement of each action to be performed in the future, expressed in a direct way as to a performing agent such as the patient or a nurse;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Performed task</strong>: statement of the action that was actually executed by the performer, in the past, e.g. 'gave 1 Amoxycillin tab at 13:37';</p>
<div class="ulist">
<ul>
<li>
<p>represented in openEHR using the types <code>ACTION</code>, <code>OBSERVATION</code> etc.</p>
</li>
<li>
<p>statement of actions, observations etc that were carried out in the past; may include different details from the Planned task.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>There may be a non-trivial relationship between each form of expression, as suits its different purpose: expressing an order; directing personnel to perform tasks; documenting what was done after the fact.</p>
</div>
<div class="paragraph">
<p>The model described here adds the second level of representation, which enables fine-grained lists of executable tasks to be explicitly stated and therefore stored in the EHR, displayed, and signed off.</p>
</div>
<div class="paragraph">
<p>We can visualise this conceptually with a modified version of the <a href="http://www.openehr.org/releases/RM/latest/ehr.html#clinical_investigator_process">Clinical Investigator process diagram</a> as follows:</p>
</div>
<div id="clinical_process_planning" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/clinical_process_planning.svg" alt="clinical process planning" width="80%">
</div>
<div class="title">Figure 4. Clinical Investigator Process with Planning</div>
</div>
<div class="paragraph">
<p>According to this scheme, <code>TASK_PLAN</code> and <code>TASK</code> are new types of information that can be committed to the EHR.</p>
</div>
</div>
<div class="sect2">
<h3 id="_separation_of_task_definition_and_execution_state"><a class="anchor" href="#_separation_of_task_definition_and_execution_state"></a>4.5. Separation of Task Definition and Execution State</h3>
<div class="paragraph">
<p>A Task Plan is essentially a definition of work to be done, or more precisely, an <em>instance</em> of a definition of work. When the work has been performed, the results are documented with openEHR Entries, such as Actions and Observations. However, there is usually a need to track the progress of the work between commencement and completion (or cancellation). Based on the model, it is possible to track:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Task execution events, which can be understood as state transitions in a notional state machine with states such as 'planned', 'completed', 'cancelled' etc;</p>
</li>
<li>
<p>Notifications to other actors of Task events, usually completion;</p>
</li>
<li>
<p>Receipt of notifications from other actors, which enable waiting Task(s) to proceed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It would be possible to track state by representing it in the Task Plan <em>definition</em>, and relying on versioning of successive commits of each update to provide the execution picture over time. However, this is not likely to correspond to the needs of the EHR, or workflow processing that occurs as the work is performed. In the former case, the execution of a non-trivial Task Plan may result in hundreds of state changes, notifications, etc, which will result in a similar number of commits to the EHR. This may be mitigated by only committing at certain points in time, but then the history of progress is lost.</p>
</div>
<div class="paragraph">
<p>On the other hand, a workflow application whose job is to use Task Plans to support work being undertaken by clinical personnel does need to carefully track the history of updates, in order to know which Tasks have been done, and which have not. Since this will often occur over multiple work shifts and/or long periods (up to two weeks for some chemotherapy), persistence is required.</p>
</div>
<div class="paragraph">
<p>The approach taken here is therefore to include in the model an explicit 'execution history ', which includes every change event during progress of the actors performing the work, as an attachment to the Task Plan, rather than to include state within each Task. This provides a means of separation of Task Plan definition from Task Plan execution state, and enables persistence of the two parts to be handled in flexible ways that suit particular environments.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_task_planning_model"><a class="anchor" href="#_task_planning_model"></a>5. Task Planning Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a>5.1. Overview</h3>
<div class="paragraph">
<p>The following UML diagram shows the <code>rm.task_planning</code> package in overview form, with the essential classes, inheritance and compositional relationships. The class <code>TASK_PLAN</code> is a descendant of <code>CONTENT_ITEM</code>, which makes it a type of content that may occur in a Composition. Compositions used for this purpose have their <code><em>category</em></code> attribute set to the openEHR coded term <code>|Task Plan|</code>. This enables Task Plans to be committed to the openEHR EHR if desired.</p>
</div>
<div class="paragraph">
<p>Structurally, a <code>TASK_PLAN</code> has a <code><em>principal_performer</em></code>, and a <code><em>definition</em></code> (blue classes). Individual Tasks that are <code>DEFINED_TASKs</code> (i.e. not references) may have a <code><em>prototype</em></code> whose type is an Entry descendant, that defines the Task data.</p>
</div>
<div class="paragraph">
<p>The <code>TASK_PLAN</code> may also have an <code><em>execution_history</em></code> (gold classes at bottom), which acts as a record of events that have occurred to the Task Plan during execution. At runtime, execution-related <code>RT_XXX</code> classes may be instantiated to track state for those parts of the definition currently being processed (central orange classes).</p>
</div>
<div id="rm_task_planning_overview" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning-overview.svg" alt="RM task planning overview">
</div>
<div class="title">Figure 5. rm.task_planning package overview</div>
</div>
<div class="paragraph">
<p>The key structural relationships are shown in the following instance diagram. On the left is the definition of a Task Plan, consisting of a Task Group and various Defined Tasks. Each of these Tasks may have a prototype Entry attached, which represents the intended data of an action or observation that the Task defines.</p>
</div>
<div class="paragraph">
<p>At the upper right is an Executing Task Plan, which is a runtime structure consisting of elements that correspond to the currently executing parts of the static definition structure (achieved by the <code>RT_PLAN_ITEM.<em>definition</em></code> association). This structure allows the recording of all state to do with Task execution, including instances of variables, timing information and so on. The Executing Task Plan structure is not owned by the definition structure, but rather is created at run time, and points back to its definition (<em>owner</em> and <em>definition</em> links).</p>
</div>
<div class="paragraph">
<p>At the lower right is a Task Execution History, which is a record of all events that were made during the execution of the original Task Plan.</p>
</div>
<div id="task_planning_overview" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_planning_overview.svg" alt="task planning overview" width="50%">
</div>
<div class="title">Figure 6. Task planning overview</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_task_definition_model"><a class="anchor" href="#_task_definition_model"></a>6. Task Definition Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>6.1. Overview</h3>
<div class="paragraph">
<p>The following figure shows the definition part of the <code>rm.task_planning</code> package.</p>
</div>
<div id="rm_task_planning_definition" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning-definition.svg" alt="RM task planning definition">
</div>
<div class="title">Figure 7. rm.task_planning package definition model</div>
</div>
<div class="sect3">
<h4 id="_compositions_and_versioning"><a class="anchor" href="#_compositions_and_versioning"></a>6.1.1. Compositions and Versioning</h4>
<div class="paragraph">
<p>If a <code>TASK_PLAN</code> and its constituent parts is created within a <code>COMPOSITION</code> for committal to the EHR (or a workflow-specific part of the EHR), it may be re-versioned as changes are made to its contents. The causes of change include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>changes to the definition, due to error correction and / or extension of the lookahead planning window;</p>
</li>
<li>
<p>additions to the execution history, corresponding to each Task or List level event, including completion or abandonment of the Task Plan.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As the <code>TASK_PLAN</code> gets progressively built and executed over time, its owning <code>COMPOSITION</code> will undergo numerous changes, corresponding both to changes to the plan definition, and also execution of the actions performed to fulfill it. Typically only the former will generate new committed versions to the EHR, whereas the latter will most likely only be used by the workflow application during execution of the Task Plan. How changes to Task Plan are versioned and added to the EHR (or not) can be handled flexibly according to local needs.</p>
</div>
</div>
<div class="sect3">
<h4 id="_basic_semantics_of_a_task_plan"><a class="anchor" href="#_basic_semantics_of_a_task_plan"></a>6.1.2. Basic Semantics of a Task Plan</h4>
<div class="paragraph">
<p>A Task Plan is specified by a number of key attributes, following the design principles described earlier, namely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>subject</em></code>: the subject of the work (i.e. 'case' in workflow parlance), typically a single patient;</p>
</li>
<li>
<p><code><em>principal_performer</em></code>: a definition of the responsible performer, normally in terms of role plus function;</p>
</li>
<li>
<p><code><em>description</em></code>: natural language specification of what the Task Plan is for;</p>
</li>
<li>
<p><code><em>care_plan</em></code>: a reference to a driving Care Plan from elsewhere in the EHR, if any exists;</p>
</li>
<li>
<p><code><em>guideline_id</em></code>, <code><em>care_pathway</em></code>: references to a guideline and/or care pathway from which this Task Plan was derived;</p>
</li>
<li>
<p><code><em>training_level</em></code>: a value that can be used to filter out fine-grained Task Plans in a chained structure only of interest to trainees.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are described in more detail below.</p>
</div>
</div>
<div class="sect3">
<h4 id="_compositional_structure"><a class="anchor" href="#_compositional_structure"></a>6.1.3. Compositional Structure</h4>
<div class="paragraph">
<p>The set of Tasks in Task Plan is represented within a containment structure created using instances of the <code>TASK_GROUP</code> type. This provides a way of grouping Tasks that will be executed collectively on the same basis, via the <code><em>execution_type</em></code> attribute, which may be set to <code>sequential</code> or <code>parallel</code>. This includes the top-level set of Tasks. A <code>TASK_GROUP</code> instance is treated as a member of its enclosing <code>TASK_GROUP</code> in the same way as constituent <code>TASK</code> instances, and shares with the latter attributes for Task description, timing, and conditions for execution.</p>
</div>
<div class="paragraph">
<p>The following illustrates the Task Plan structure including nested Task Groups.</p>
</div>
<div id="task_grouping" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_grouping.svg" alt="task grouping" width="25%">
</div>
<div class="title">Figure 8. Task grouping</div>
</div>
</div>
<div class="sect3">
<h4 id="_basic_semantics_of_a_task"><a class="anchor" href="#_basic_semantics_of_a_task"></a>6.1.4. Basic Semantics of a Task</h4>
<div class="paragraph">
<p>The important semantics of the Task concept in the model are specified in the <code>PLAN_ITEM</code> and <code>TASK_ITEM</code> classes, with further specifics appearing in the <code>TASK_GROUP</code> and <code>TASK</code> descendants. Key attributes the <code>PLAN_ITEM</code> and <code>TASK_ITEM</code> include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>description</em></code>: natural language specification of the work of the Task;</p>
</li>
<li>
<p><code><em>preconditions</em></code>: operational conditions for determining if a Task is available for execution by a performer;</p>
</li>
<li>
<p><code><em>wait_conditions</em></code>: specification of coordinating wait conditions for Task completion by another performer;</p>
</li>
<li>
<p><code><em>notifications</em></code>: specification of coordinating notifications to be sent to other performer / Task contexts;</p>
</li>
<li>
<p><code><em>execution_time</em></code>: optional timing plan for Tasks;</p>
</li>
<li>
<p><code><em>indications</em></code>: clinical conditions for the Task being applicable;</p>
</li>
<li>
<p><code><em>optionality</em></code>: indicates whether the Task is regarded as optional or mandatory in the overall Task plan, typically set by a guideline;</p>
</li>
<li>
<p><code><em>costing_data</em></code>: fine-grained data to enable cost determination of work performed;</p>
</li>
<li>
<p><code><em>other_participations</em></code>: participations other than the principal performer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these is explained in detail below.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_plan_compositional_structure"><a class="anchor" href="#_task_plan_compositional_structure"></a>6.1.5. Task Plan Compositional Structure</h4>
<div class="paragraph">
<p>As mentioned in the requirements section, the granularity of a Task can be variable from one healthcare context to another, as per the cannulation example. This leads to two possibilities for representing a real world Task:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>atomic representation</em>: a Task that may in reality consist of several fine-grained steps may be represented within a Task Plan as a single Task, on the assumption that the performer will correctly determine how to execute it;</p>
</li>
<li>
<p><em>reference to composite representation</em>: a Task definition may refer out to a separate Task Plan containing further sub-tasks representing the detailed steps needed to achieve it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The model described here thus makes no <em>a priori</em> assumptions about granularity of representation of a given real-world task, and both representations are possible. This first kind is thus represented as an instance of the class <code>DEFINED_TASK</code>, while the second is achieved with the use of an <code>EXTERNAL_PLAN</code> which refers out to another <code>TASK_PLAN</code> to be executed by the same performer.</p>
</div>
<div class="paragraph">
<p>The <code>EXTERNAL_PLAN</code> type gives rise to the possibility of a hierarchy of linked Task Plans, with each successive member in the chain representing a more detailed form of a given real world task. This can be visualised as follows.</p>
</div>
<div id="task_linking" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_linking.svg" alt="task linking" width="70%">
</div>
<div class="title">Figure 9. Task Plan linking</div>
</div>
<div class="paragraph">
<p>A structure like the above may be used differently by performers of differing training levels - since each <code>EXTERNAL_PLAN</code> has its own inherited <code><em>description</em></code>, an expert user may require no further list of steps, but a trainee might make use of the full hierarchical structure. The <code><em>training_level</em></code> attribute on <code>TASK_PLAN</code> can be used to control this. A higher value corresponds to a lower level of expertise, and different values can be set on different linked <code>TASK_PLANs</code>. The workflow application may treat different users as being of different training levels, in which case Task Plans of higher training levels can be hidden. In the above example, a principal performer with trainee level = 7 will see the three Task Plans on the left, but not the final one, since it has a trainee level of 10.</p>
</div>
<div class="paragraph">
<p>The default value of <code><em>training_level</em></code> is 0.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_task_definition"><a class="anchor" href="#_task_definition"></a>6.2. Task Definition</h3>
<div class="paragraph">
<p>The description of the work of a Task or Task Group is stated in the <code><em>description</em></code> attribute, inherited from <code>PLAN_ITEM</code>. This applies to <code>DEFINED_TASKs</code> (inline definitions) and external Plan references. A detailed specification of the work to be done in concrete (i.e. inline) Task definition may be stated via the <code>DEFINED_TASK</code> class optional atttribute <code><em>prototype</em></code>, of type <code>ENTRY</code>, which enables the details of a Task to be specified in terms of a descendant of the <code>ENTRY</code> class. This is typically an <code>ACTION</code> instance but could be an <code>OBSERVATION</code>, <code>ADMIN_ENTRY</code> or other descendant.</p>
</div>
<div class="paragraph">
<p>The attribute is called 'prototype' because the target Entry instance is understood as a partially populated, prototype 'planning time' partial copy of an Entry that will be created when the Task is actually performed. For example, a Task Plan for administering medication at 8 hourly intervals over a number of days could consist of a number of <code>DEFINED_TASKs</code>, each having a protoype of an <code>ACTION</code> instance based on the <code>openEHR-EHR-ACTION.medication.v1</code> archetype or a templated version thereof. Each such instance would contain the structured description of the medication administration and time, and when the administration was actually performed, an <code>ACTION</code> instance would be created from the prototype, modified to reflect any divergence from the planned form of the Task, and committed to the EHR in the normal way.</p>
</div>
<div class="paragraph">
<p>The following illustrates Task definitions using prototypes.</p>
</div>
<div id="task_definition" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_definition.svg" alt="task definition" width="35%">
</div>
<div class="title">Figure 10. Task definition</div>
</div>
<div class="paragraph">
<p>Assuming that the Task Plan is archetyped in the same way as Entries and other elements of the EHR, this scheme supports various modes of design-time specification. The <code><em>prototype</em></code> attribute in a <code>TASK_PLAN</code> archetype will usually be represented by an archetype slot or external reference, which specifies identifiers of permitted archetypes (or templates) of the target type, i.e. <code>ACTION</code> or other Entry. This can be used in various ways, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.openehr.org/releases/AM/latest/ADL2.html#_external_references">external reference</a>: specifies a fixed archetype identifier which will be substituted in the templated form of the Task Plan. This has the effect of creating <code>ACTION</code> or other prototype instances in the <code>TASK_PLAN</code> structure;</p>
</li>
<li>
<p><a href="http://www.openehr.org/releases/AM/latest/ADL2.html#_archetype_slots">archetype slot</a>: specified using a slot constraint that is satisfied by one or more archetypes that may be specified by a template, or left open until runtime.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the latter case, the slot may be filled in the Task Plan template with an <code>ACTION</code> or other Entry archetype, allowing the Tasks to be fully specified inline as in the external reference case. Alternatively, it may be left unresolved, which would allow the workflow application to choose the exact Task definition archetype at runtime.</p>
</div>
<div class="paragraph">
<p>One reason to allow a Task to contain a <code><em>prototype</em></code> reference that remains unresolved until runtime is if the Task represents the act of making an observation, for example, taking a blood pressure. In such cases, no prototype at all may be needed, and the Task <code><em>description</em></code> attribute (inherited from <code>PLAN_ITEM</code>) may be sufficient information for the performer. On the other hand, a prototype <code>OBSERVATION</code> could be specified in the <code>TASK_PLAN</code> template, which defines a particular form of the observation, e.g. a blood pressure which only records mean arterial pressure and cuff size.</p>
</div>
<div class="paragraph">
<p>To allow further flexibility, The multiplicity of the <code><em>prototype</em></code> attribute is unlimited, to allow for the possibility of one Task being prototyped by more than one Entry instance, e.g. an <code>ACTION</code> and an <code>OBSERVATION</code>, two <code>ADMIN_ENTRY</code> instances and so on.</p>
</div>
<div class="paragraph tbd">
<p>ISSUE-task-entry-corr: the alternative seems to be to allow a Task to correspond to e.g. a whole Composition template, where the <code>COMPOSITION</code> contains a number of e.g. <code>ACTIONs</code> or <code>OBSERVATIONs</code>. Problems I see with this: a) who knows what is in the Composition template? It may change over time; b) what if only some of the items in the Composition template can be done? Is the Task half complete? Or should the performer not do any of it?</p>
</div>
<div class="sect3">
<h4 id="_coordinated_teamwork"><a class="anchor" href="#_coordinated_teamwork"></a>6.2.1. Coordinated Teamwork</h4>
<div class="paragraph">
<p>Performing teamwork in a coordinated fashion with task planning support necessarily requires multiple Task Plans - one for each actor, and a means of coordination among them. This is achieved by the use of <code>TASK_NOTIFICATION</code> class and the attributes <code><em>notifications</em></code> and <code><em>wait_conditions</em></code>, which respectively represent outgoing notifications to other actors, and a 'wait state' that is unblocked by receipt of a notification from another Task Plan and actor.</p>
</div>
<div class="paragraph">
<p>These two attributes enable both directions of communication between any two actors working in a coordinated workflow to be expressed. The following illustrates, using the example of an acute stroke management care process.</p>
</div>
<div id="task_coordination" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_coordination.svg" alt="task coordination" width="70%">
</div>
<div class="title">Figure 11. Task coordination</div>
</div>
</div>
<div class="sect3">
<h4 id="_timing"><a class="anchor" href="#_timing"></a>6.2.2. Timing</h4>
<div class="paragraph">
<p>In the coordinated team work situation, the timing of Tasks tends to be based on previous Tasks completing and/or receipt of completion notifications from Tasks being performed by other actors. However, for scenarios such as routine drug administration, the timing of Tasks can be specified directly.</p>
</div>
<div class="paragraph">
<p>This is achieved via the <code><em>execution_time</em></code> attribute, whose value at runtime is understood as a guide, enabling Tasks to be placed on a scheduled timeline. A performer may execute the Task earlier or later than the indicated time, with the final <code>ACTION</code> or other Entry recording the actual time.</p>
</div>
<div class="paragraph">
<p>The timing of a Task, may be expressed in three different ways, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>clock time</em>: the Task is to be executed at a specific clock time represented by an instance of <code>CLOCK_TIMING</code>; within a Task definition, this must be specified as a relative duration with respect to the origin clock time of the Task Plan, which is only known in absolute terms at execution time;</p>
</li>
<li>
<p><em>event-linked time</em>: the Task is to be executed at a time related to a real world event, such as a meal or sleeping; in this case, an instance of <code>EVENT_LINKED_TIME</code> is used; the attributes indicate the specifics such as '1 hour before', 'with meal' etc;</p>
</li>
<li>
<p><em>task-link time</em>: the Task is to be executed at a time related to the timing of another Task event, such as completion of the previous Task; this is represented by an instance of <code>TASK_LINKED_TIME</code>, whose attributes define the specifics.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these timing specification types inherits from the <code>TIMING_SPEC</code> class, which provides an optional <code><em>start_window</em></code> attribute, enabling any time to be specified with an additional 'within x time'.</p>
</div>
<div class="paragraph">
<p>If no <code><em>execution_time</em></code> is specified, a Task is assumed to be available for execution if other (non-temporal) availability conditions are met and:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for Tasks in a sequential group, as soon as the previous Task has been completed;</p>
</li>
<li>
<p>for Tasks in a parallel group, as soon as the group becomes available.</p>
</li>
</ul>
</div>
<div class="paragraph tbd">
<p>ISSUE-time-relativity: time is somewhat complicated. In a TASK_PLAN archetype we need to use relative offsets everywhere, but at runtime, we need absolute times. We could consider setting an 'origin time' for the Task Plan as a whole when it is instantiated, and computing absolute times for each Task at that point. However, at runtime, the timings may be changed by the performer (e.g. times to admin drugs) and the intention is probably to make them 'stick', even if the notional origin time is moved. However in other cases, the idea may be to move the origin and have all the times move.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pre_conditions"><a class="anchor" href="#_pre_conditions"></a>6.2.3. Pre-conditions</h4>
<div class="paragraph">
<p>In addition to timing, other conditions may determine when or if a Task can be performed. These are modelled as the <code>TASK_ITEM</code> attribute <code><em>preconditions</em>: TASK_PRECONDITION</code>. A precondition is formally represented as a <code>DV_PARSABLE</code>, which would normally contain a string in <a href="http://www.openehr.org/releases/BASE/latest/expression.html">openEHR Expression Language</a> syntax, but may contain another syntax.</p>
</div>
<div class="paragraph">
<p>Pre-conditions can be used in two ways. They may express real-world conditions containing references to EHR-available data items, such as vital signs, white cell count or other such things. Alternatively, they may be used as part of a decision group structure, in which case they reference a variable from a <code>DECISION_GROUP</code> instance. This is described in more detail below.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_decision_structures"><a class="anchor" href="#_decision_structures"></a>6.3. Decision Structures</h3>
<div class="paragraph">
<p>A more advanced application of Task Plans includes decision structures in which Tasks are executed conditionally according to logic statements included in the Task Plan. In this model, a decision structure is represented by the classes <code>DECISION_GROUP</code> and <code>DECISION_PATH_GROUP</code>. These enable the decision points found in guidelines to be represented. The following diagram shows a typical decision structure.</p>
</div>
<div id="decision_structure" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/decision_structure.svg" alt="decision structure" width="50%">
</div>
<div class="title">Figure 12. Decision structure</div>
</div>
<div class="paragraph">
<p>A decision point is represented by a <code>DECISION_GROUP</code> instance, which contains a <code><em>value_expression</em></code> in the form of an assignment of an expression to a variable that can be later tested, and has its <code><em>execution_type</em></code> set to <code>conditional</code>. Each pathway is represented by a <code>DECISION_PATH_GROUP</code> instance with a <code><em>test_expression</em></code> in the form of an assertion on the same variable. By this method, the workflow engine can determine which group to execute based on the runtime value of the variable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_task_availability"><a class="anchor" href="#_task_availability"></a>6.4. Task Availability</h3>
<div class="paragraph">
<p>A workflow application or engine executing a Task Plan can determine the availability for execution of any Task Group or Task as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>timing</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Task execution time, if set, with respect to current time;</p>
</li>
<li>
<p>check completion status of preceding Tasks / Groups within the current Task Group;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>validity</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>check that Task wait notifications have been received from related Task Plans executing in the same group;</p>
</li>
<li>
<p>check Task preconditions, assessed by executing precondition expressions against the EHR.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow application may provide an override capability so that a Task can be performed before it is determined to be available. This would enable a user to perform the Task anyway, with the corresponding <code>TASK_EVENT_RECORD</code> recording the use of override.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_descriptions"><a class="anchor" href="#_class_descriptions"></a>6.5. Class Descriptions</h3>
<div class="sect3">
<h4 id="_task_plan_class"><a class="anchor" href="#_task_plan_class"></a>6.5.1. TASK_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Logical list of Tasks in a structure defining order and conditions of execution of items of work intended to achieve a goal. A Task Plan consists of a top-level TASK_GROUP containing PLAN_ITEMs, which are either atomic TASKs, more TASK_GROUPs or DECISION nodes.</p>
</div>
<div class="paragraph">
<p>A Task Plan specifies a principal_performer, representing a kind of actor who can perform the Tasks, and bounding start_time and completion_time information.</p>
</div>
<div class="paragraph">
<p>It has an associated execution_history that can be used to record work events in time.</p>
</div>
<div class="paragraph">
<p>The attributes care_plan and guideline_id provide a way of associating a Task Plan with an operational care plan, and also a published guideline or protocol on which the Task Plan may be based.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">CONTENT_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>subject</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional indicator of subject of Task, which is normally the subject of the EHR. If this is not the case, this attribute states who the Task is to be performed on.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Human-understandable description of the Task Plan, which may be specific to the work items and patient.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>care_plan</strong>: <code>LOCATABLE_REF</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Care plan object from which this Task Plan is derived.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>guideline</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of guideline on which this Task Plan is based, if such exists. A 'guideline' is understood here as a published standard for performing a detailed Task.</p>
</div>
<div class="paragraph">
<p>It is currently assumed that there is no reliable machine identifier system for guidelines. A DV_IDENTIFIER allows things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>issuer = "NICE";</p>
</li>
<li>
<p>id = "https://www.nice.org.uk/guidance/cg180"</p>
</li>
<li>
<p>type = "NHS guideline for Atrial fibrillation: management"</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>principal_performer</strong>: <code>TASK_PARTICIPATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Specification of principle performer of this Task Plan as a Participation, in terms of role and optionally function, mode and specific performer as appropriate.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>care_pathway</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of care pathway etc, on which this Task Plan is based, if such exists. A 'care pathway' is understood here as a published standard for performing care for a major condition or presenting complaint, e.g. sepsis, MI etc.</p>
</div>
<div class="paragraph">
<p>It is currently assumed that there is no reliable machine identifier system for care pathways. A DV_IDENTIFIER allows things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>issuer = "NICE";</p>
</li>
<li>
<p>id = "https://pathways.nice.org.uk/pathways/sepsis"</p>
</li>
<li>
<p>type = "NICE Sepsis care pathway"</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The Tasks for this Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_history</strong>: <code>TASK_PLAN_EXECUTION_HISTORY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>History of execution events for an execution of this Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>training_level</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An integer value representing the training level for which this Task Plan is designed. A high value corresponds to a lower level of expertise. The default value is zero.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>best_practice_ref</strong>: <code>DV_URI</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A URI (typically a local URL) that points to the document form of any governing guideline or other best practice publication in use in the current institution. This link provides a way for a clinician to cross-check the Task Plan design and functioning against the definitive document that acts as the source of its semantics.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expiry_time</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Maximal date/time by which this Task Plan should be considered obsolete. If not set, the Task Plan would normally be inferred to be obsolete after a discharge from acute care, but in primary or social care situations, no value may be assumed to indicate that the Tasks are still to be performed, depending on the times specified in the execution_time attribute of TASKs in the plan.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_participation_class"><a class="anchor" href="#_task_participation_class"></a>6.5.2. TASK_PARTICIPATION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PARTICIPATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Class defining a participation in Task(s), minimally in terms of function. Optionally, the role and mode may also be specified. The performer attribute enables a specific actor to be specified.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">LOCATABLE</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>function</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The function of the Party in this participation (note that a given party might participate in more than one way in a particular activity). This attribute should be coded, but cannot be limited to the HL7v3:ParticipationFunction vocabulary, since it is too limited and hospital-oriented.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>role</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Organisational role, i.e. the professional type of participant in the activity. Preferably coded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mode</strong>: <code>DV_CODED_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional field for recording the 'mode' of the performer / activity interaction, e.g. present, by telephone, by email etc.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>performer</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The id and possibly demographic system link of the party participating in the activity.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>optionality</strong>: <code>VALIDITY_KIND</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Condition for participation in the Plan item.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_plan_item_class"><a class="anchor" href="#_plan_item_class"></a>6.5.3. PLAN_ITEM Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>PLAN_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Parent type of all item types that may appear within a Task Plan structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">LOCATABLE</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>item_id</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Integer indicating the ordinal number of this Task within its Task group. Used for referencing from other objects. Required to be unique with respect to other siblings in the same Task group.</p>
</div>
<div class="paragraph">
<p>Identification of any Task in a Task Plan is done using paths of the form /task_group_id/task_group_id.</p>
</div>
<div class="paragraph">
<p>TODO: needed?</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Human-readable form of the task directive.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_item_class"><a class="anchor" href="#_task_item_class"></a>6.5.4. TASK_ITEM Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>TASK_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent type of the Task definition types TASK_GROUP and TASK.</p>
</div>
<div class="paragraph">
<p>Supports definition of optionality, pre-conditions, wait conditions, indications and notifications with any Task Group or Task.</p>
</div>
<div class="paragraph">
<p>Provides a place to record fine-grained costing data.</p>
</div>
<div class="paragraph">
<p>Informal other participations can also be recorded for any Task Group or Task, although these do not replace the Task Plan principal_performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">PLAN_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_participations</strong>: <code>List&lt;TASK_PARTICIPATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of participations for task item.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>costing_data</strong>: <code>TASK_COSTING</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Costing data related to this Task item.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preconditions</strong>: <code>List&lt;TASK_PRECONDITION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Condition which must be met for the TASK_ITEM to be available to perform in a runtime execution context.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>indications</strong>: <code>List&lt;DV_TEXT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Causal drivers or applicability of this Task item to subject of work, e.g. 'pregnancy', 'lymphoma' etc. May be derived from a governing guideline. May be displayed as a safety precaution to human performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>notifications</strong>: <code>List&lt;TASK_NOTIFICATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of notifications to be generated on a state change of this Task during execution.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>wait_conditions</strong>: <code>List&lt;TASK_NOTIFICATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of wait conditions for this Task, expressed in terms of external actors and Tasks that need to complete before this Task may be commenced.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>optionality</strong>: <code>VALIDITY_KIND</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Condition of execution (typically according to governing protocol): mandatory &#124; recommended &#124; optional &#124; expression .</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>ITEM_STRUCTURE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Archetypable structure for recording non hard-modelled information.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_time</strong>: <code>TIMING_SPEC</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional specifier of time at which the Task of Task Group should be performed. If not provided, the Task is assumed to be available to perform immediately following completion of the previous members of the parent Task Group.</p>
</div>
<div class="paragraph">
<p>The Task may be performed earlier or later than this time; it is understood as a guide only.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Attribute for recording lifecycle_state of this Task from corresponding Task in live execution model.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_timing_spec_class"><a class="anchor" href="#_timing_spec_class"></a>6.5.5. TIMING_SPEC Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>TIMING_SPEC (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Parent of classes representing ways to specify time of an action to be performed.</p>
</div>
<div class="paragraph tbd">
<p>TODO: probably need an option for coded times like 'afternoon', 'midday' etc.</p>
</div>
<div class="paragraph tbd">
<p>ISSUE-generic-planned_time: These classes should probably be made generic and added to the BASE component. Needs to take into account some of the other models of time specification. See e.g. openEHR-EHR-CLUSTER.timing_daily.v0.0.1 for other design concepts.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_window</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time window after an initial time during which the action should start. Allows for approximate times to be used operationally.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_clock_timing_class"><a class="anchor" href="#_clock_timing_class"></a>6.5.6. CLOCK_TIMING Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CLOCK_TIMING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Represents a time at which a single future event or action should take place in terms of an offset from an origin.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TIMING_SPEC</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_offset</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time at which the action should start, specified as an offset from the Task Plan origin time.  The effective real time to start operationally can be computed from an absolute origin time plus this offset.</p>
</div>
<div class="paragraph">
<p>If start_window is set, the action may start within this a certain duration after the start_offset.</p>
</div>
<div class="paragraph">
<p>If set, relative_offset and relative_time_qualifier are not set.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_event_linked_timing_class"><a class="anchor" href="#_event_linked_timing_class"></a>6.5.7. EVENT_LINKED_TIMING Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EVENT_LINKED_TIMING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Represents a time at which a single future event or action should take place in terms of a real world event such as 'meal', a relative ordering with respect to the event, e.g. 'before', and an optional time offset, e.g. 3h. This allows time specifications like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>with (at) sleep time</p>
</li>
<li>
<p>3h before</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TIMING_SPEC</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event_offset</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Relative time offset with respect to origin nominated in relative_time_qualifier.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event_type</strong>: <code>DV_CODED_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Indicates that the action should be aligned with a real world event. Typical values: meal, evening meal, sleep, toilet.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event_order</strong>: <code>TEMPORAL_RELATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Order of event_offset with respect to event_type.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_temporal_relation_enumeration"><a class="anchor" href="#_temporal_relation_enumeration"></a>6.5.8. TEMPORAL_RELATION Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TEMPORAL_RELATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration of relative temporal relations.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">before</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Before a reference event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">with</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>At the same time as a reference event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">after</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>After a reference event.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_linked_timing_class"><a class="anchor" href="#_task_linked_timing_class"></a>6.5.9. TASK_LINKED_TIMING Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_LINKED_TIMING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Represents a time at which a single future event or action should take place in terms of a time relative to completion of another Task or other task-related event.</p>
</div>
<div class="paragraph tbd">
<p>Need to specify this better.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TIMING_SPEC</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>reference_item</strong>: <code>TIMING_REFERENCE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Indicates what time origin to use for this action in terms of other actions. May take values such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>after_previous: after the previous action in a list, by the offset duration if any;</p>
</li>
<li>
<p>after_start: after the start of the list, by the offset duration if any.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>relative_offset</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Relative time offset with respect to origin nominated in relative_time_qualifier.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_timing_reference_enumeration"><a class="anchor" href="#_timing_reference_enumeration"></a>6.5.10. TIMING_REFERENCE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TIMING_REFERENCE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration of types of temporal reference within a Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">previous_task</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The previous task in a series of tasks.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">current_group</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The start time of the current group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_group_class"><a class="anchor" href="#_task_group_class"></a>6.5.11. TASK_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Grouping structure that defines the execution basis for a collection of Tasks, which may include more Task groups.</p>
</div>
<div class="paragraph">
<p>The execution_type attribute defines the mode of execution. If not set, sequential execution is assumed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;PLAN_ITEM&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of Tasks to perform. Sequencing is either the natural order of the tasks list, or may be controlled by</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_type</strong>: <code>EXECUTION_TYPE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Basis for executing the Task items contained in this Task Group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_decision_group_class"><a class="anchor" href="#_decision_group_class"></a>6.5.12. DECISION_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DECISION_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A specialised node that represents a decision point in guideline-based Task Plan definition. The decision is represented by the value_expression, which at runtime is instantiated as an ASSIGNMENT.</p>
</div>
<div class="paragraph">
<p>Instances of this class also act as a container for the subordinate decision paths which are modelled as TASK_GROUPs with execution_type = decisional, and each having a precondition representing a match expression for the value generated by the value_expression on the parent DECISION_GROUP object.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">PLAN_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value_expression</strong>: <code>DV_PARSABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An expression in the form of a variable assignment from an expression or a plain variable reference, if no expression is required. The same variable will appear in the test_expressions of all immediate child paths.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>paths</strong>: <code>List&lt;DECISION_PATH_GROUP&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of Task Groups that are also decision paths in this Decision Group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_decision_path_group_class"><a class="anchor" href="#_decision_path_group_class"></a>6.5.13. DECISION_PATH_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DECISION_PATH_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A specialised kind of TASK_GROUP that corresponds to a particular decision path branch from a DECISION_GROUP.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK_GROUP</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>test_expression</strong>: <code>DV_PARSABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A test expression on a variable whose value is defined by the value_expression attribute of the owning DECISION_GROUP.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_execution_type_enumeration"><a class="anchor" href="#_execution_type_enumeration"></a>6.5.14. EXECUTION_TYPE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXECUTION_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration specifying types of execution for a set of Tasks.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">sequential</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Items execute in order, one after the other.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">parallel</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Items may be executed in parallel, with no regard to order in the representation.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_class"><a class="anchor" href="#_task_class"></a>6.5.15. TASK Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>TASK (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of various types of planned Task, which may be real work items (DEFINED_TASK) or references to another Task Plan (EXTERNAL_PLAN).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK_ITEM</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_external_plan_class"><a class="anchor" href="#_external_plan_class"></a>6.5.16. EXTERNAL_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXTERNAL_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task type that represents a dispatch to another Task Plan to be executed by the current performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>target</strong>: <code>TASK_PLAN</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>UID of target TASK_LIST object.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_defined_task_class"><a class="anchor" href="#_defined_task_class"></a>6.5.17. DEFINED_TASK Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DEFINED_TASK</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Type of Task that represents concrete tasks, i.e. real work items. The definition of the work of the Task is expressed in terms of archetype of an ENTRY (usually an ACTION) that will be used to record the Task&#8217;s execution.</p>
</div>
<div class="paragraph">
<p>The entry_instance attribute can be used to record a forward reference to an ACTION or other ENTRY when it has been recorded.</p>
</div>
<div class="paragraph">
<p>May be specialised in order to add attributes required by the Task form of specific Entry subtypes, hence, ACTION_TASK etc.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">TASK</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>prototype</strong>: <code>List&lt;ENTRY&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Prototype instance of one or more Entries that express the specific work of the Task. Normally one Entry would be used, typically an ACTION, but more than one may sometimes make sense, e.g. an ACTION and an OBSERVATION.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_notification_class"><a class="anchor" href="#_task_notification_class"></a>6.5.18. TASK_NOTIFICATION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_NOTIFICATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Object representing a notification to another party at a defined Task event, e.g. commencement, completion.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>target</strong>: <code>TASK_PARTICIPATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The target party, expressed in terms of role and/or function.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>trigger_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task lifecycle state that triggers notification.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_precondition_class"><a class="anchor" href="#_task_precondition_class"></a>6.5.19. TASK_PRECONDITION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PRECONDITION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Conditions expressing when the Task is executable with respect to the principal performer and subject. Coordination with other actors and Task Plans are represented as Wait conditions.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>List&lt;DV_TEXT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Textual representation of preconditions for this Task to be performed, according to governing protocol. May be displayed as a safety check for human performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expression</strong>: <code>DV_PARSABLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>In the case that required_status /= mandatory; a Boolean expression that can be evaluated at runtime to determine inclusion.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_task_execution_model"><a class="anchor" href="#_task_execution_model"></a>7. Task Execution Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>7.1. Overview</h3>
<div class="paragraph">
<p>The following figure shows the execution related part of the <code>rm.task_planning</code> package. The consists of two parts: the runtime part, and the 'execution history' part. The former is a partial specification of classes that could be instantiated at Task Plan execution time to track Plan execution, and is provided as a guide to how execution tracking can be done. The latter classes describe the execution history after the fact, in the form of 'event records' that can optionally be stored in the EHR after Task Plan execution has completed.</p>
</div>
<div id="rm_task_planning_execution" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-task_planning-execution.svg" alt="RM task planning execution">
</div>
<div class="title">Figure 13. rm.task_planning package - execution model</div>
</div>
</div>
<div class="sect2">
<h3 id="_task_plan_execution_tracking"><a class="anchor" href="#_task_plan_execution_tracking"></a>7.2. Task Plan Execution Tracking</h3>
<div class="paragraph">
<p>There are various aspects to Task Plan execution, some of which are complex, and not directly covered by this specification. The execution phases are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>instantiation</strong>: create an instance of this Task Plan in the Task Plan application;</p>
</li>
<li>
<p><strong>allocation</strong>: allocate the Plan instance to an authenticated user, as principal performer;</p>
</li>
<li>
<p><strong>execution</strong>: the Task Plan application displays Tasks and advances the state of execution view interactions with the user;</p>
<div class="ulist">
<ul>
<li>
<p>each interaction, also change of principal performer, abandonment, and any other events will cause generation of Execution history events, which may be persisted;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>commit to EHR</strong>: an updated state of the Task Plan may be committed to the EHR, containing final lifecycle states and execution history.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>During a long-running Task Plan, the principal performer may change. This will usually be the case for Task Plans that run longer than a work shift.</p>
</div>
<div class="sect3">
<h4 id="_task_plan_instantiation"><a class="anchor" href="#_task_plan_instantiation"></a>7.2.1. Task Plan Instantiation</h4>
<div class="paragraph">
<p>Initially, a Task Plan definition that has been created will have the lifecycle state value <code>planned</code> in each <code>TASK_ITEM</code> instance. When the definition is activated, it is instantiated within a Task execution application. This creates a copy of it, or part of it, along with instances of the <code>RT_XXX</code> classes ('RT' = runtime).</p>
</div>
<div class="paragraph">
<p>At instantiation, an instance of <code>RT_TASK_PLAN</code> is created and the  <code><em>start_time</em></code> attributes set to the current time respectively. This object will normally be maintained for the lifetime of execution of the Task Plan. If there are execution times in the plan, they will be trivially convertable to absolute clock times.</p>
</div>
<div class="paragraph">
<p>The runtime form of the detailed structure of the plan may be instantiated fully, or only partially, where convenient. For example, if most of the plan has been completed, and only some steps remain, it may make sense to instantiate only the <code>RT_XX</code> instances corresponding to those steps. On the other hand, an applicaiton may want to display the details of the whole plan, even when only a small part remains to be executed.</p>
</div>
<div class="paragraph">
<p>The structure created will mirror the structure of the definition, to the extent of run-time structure creation, if it is partial. That is to say, <code>RT_TASK_GROUP</code> instances will have <code><em>members</em></code> containing further <code>RT_XX</code> instances, that mimic the <code>TASK_GROUP</code> structures within the Plan definition.</p>
</div>
<div class="paragraph">
<p>When the structure creation has been completed, the <code><em>lifecycle_state</em></code> attribute of one or more <code>RT_TASK</code> instances may be set to <code>available</code>, or if picking up from a previous session, to other states (i.e. <code>completed</code> etc), as appropriate.</p>
</div>
<div class="paragraph">
<p>At the same time, an instance of <code>EXECUTION_HISTORY</code> is also created, proving a root points to accumulate Task Plan execution event records.</p>
</div>
</div>
<div class="sect3">
<h4 id="_allocation"><a class="anchor" href="#_allocation"></a>7.2.2. Allocation</h4>
<div class="paragraph">
<p>Before an instantiated Task Plan can be executed, it must be allocated. This is done by user authenticating to the Task Plan application; this user will be set as the <code><em>principal_performer</em></code> in the <code>RT_TASK_PLAN</code> instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_lifecycle_model"><a class="anchor" href="#_task_lifecycle_model"></a>7.2.3. Task Lifecycle Model</h4>
<div class="paragraph">
<p>During execution, each Task is represented by an instance of <code>RT_TASK</code> that refers back to its <code>TASK</code> definition instance. Each Task in the Plan has a lifecycle consisting of various states it may pass through in time. Changes in the lifecycle are recorded in <code>RT_TASK.<em>lifecycle_state</em></code>. The lifecycle is simple, since it only has to take account of the states a Task itself can pass through, with documentation of the Task execution occurring in the form of separate openEHR <code>ACTION</code> or other Entry objects. The states are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>initial</em>: initial pseudo-state, not used in operation;</p>
</li>
<li>
<p><em>planned</em>: defined, but not available for execution;</p>
</li>
<li>
<p><em>available</em>: available for execution, due to previous Tasks having been performed, preconditions being met, wait conditions having been satisfied and if there is a time specification on the Task, the current time being at or later than the stated time;</p>
</li>
<li>
<p><em>cancelled</em>: cancelled prior to being performed;</p>
</li>
<li>
<p><em>completed</em>: performed to completion;</p>
</li>
<li>
<p><em>aborted</em>: execution was commenced but stopped before completion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The corresponding state machine is shown below.</p>
</div>
<div id="task_state_machine" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/RM-TaskStateMachine.svg" alt="RM TaskStateMachine" width="60%">
</div>
<div class="title">Figure 14. Task lifecycle state machine</div>
</div>
<div class="paragraph">
<p>It may be that one or more Tasks do not evaluate to <code>available</code> at runtime when the principal performer wants to treat them as being available. This may happen if the performer wants to execute a Task earlier than scheduled, or decides that an unmet precondition or wait condition does not matter (for example, they may know that it is met, but the Task Plan application may not yet know). Accordingly, an override option</p>
</div>
<div class="paragraph">
<p>Since a Task Plan is a hierarchical structure consisting of one or more Task Groups, a way of rolling up Task state is needed. The following algorithm is used to compute the effective lifecycle state of a <code>RT_TASK_GROUP</code> from the set of states of its members (which may include other <code>RT_TASK_GROUPs</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-c1">//</span>
<span class="tok-c1">// Infer the state of a collection whose members have states in sourceStates.</span>
<span class="tok-c1">// The order of if/else evaluation determines the correct result.</span>
<span class="tok-c1">//</span>
<span class="tok-n">TaskState</span> <span class="tok-nf">inferredState</span> <span class="tok-o">(</span><span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">TaskState</span><span class="tok-o">&gt;</span> <span class="tok-n">sourceStates</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">TaskState</span> <span class="tok-n">inferredStateValue</span><span class="tok-o">;</span>
    <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Available</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Available</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Planned</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Planned</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Completed</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Completed</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Aborted</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Aborted</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Cancelled</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Cancelled</span><span class="tok-o">;</span>
    <span class="tok-k">else</span>
        <span class="tok-k">return</span> <span class="tok-n">Initial</span><span class="tok-o">;</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the runtime Task Group is also the top-level structure of the runtime Task Plan, the inferred state of the Plan as a whole is also provided by this algorithm applied to the top-level runtime Task Group.</p>
</div>
<div class="paragraph">
<p>Lifecycle state values recorded in <code>RT_TASK</code> objects may be copied into the <code><em>lifecycle_state</em></code> attributes of the corresponding definition Task objects if required, for example, in order to persist a final snapshot of the Task Plan into the EHR.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is the only execution time related attribute in the Task Plan definition. If it is necessary to record the final lifecycle states of Tasks in a completed Task Plan, the <code>TASK_PLAN</code> will need to be re-committed to the EHR as a new version in order to achieve this.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_notifications"><a class="anchor" href="#_notifications"></a>7.2.4. Notifications</h4>
<div class="paragraph">
<p>Notifications can be specified to be generated at various lifecycle state changes.</p>
</div>
<div class="paragraph tbd">
<p>To be continued</p>
</div>
</div>
<div class="sect3">
<h4 id="_persistence"><a class="anchor" href="#_persistence"></a>7.2.5. Persistence</h4>
<div class="paragraph">
<p>The run-time instance structure may need to be persisted to enable a partial execution of a long-running Task Plan to be recorded and picked up when later tasks become ready. In theory, this could be within the EHR, but it is recommended that either a specific EHR area be used for this, or that run-time state persistence be implemented outside the EHR proper.</p>
</div>
<div class="paragraph tbd">
<p>issue-runtime-persistence: if within the EHR, we could create a new 'pointer' on the EHR object that points to 'task runtime state' data or similar. Is this a useful thing to do?</p>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions_2"><a class="anchor" href="#_class_descriptions_2"></a>7.2.6. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_lifecycle_enumeration"><a class="anchor" href="#_task_lifecycle_enumeration"></a>7.2.6.1. TASK_LIFECYCLE Enumeration</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_LIFECYCLE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration representing possible lifecycle states for a Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">planned</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task is planned for the future.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">available</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task is available for execution by performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">cancelled</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was cancelled without commencing.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">aborted</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was aborted after commencement, i.e. ended prematurely without meeting normal conditions of completion.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">completed</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was completed in the intended way.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rt_task_plan_class"><a class="anchor" href="#_rt_task_plan_class"></a>7.2.6.2. RT_TASK_PLAN Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RT_TASK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Root object of an executing Task Plan structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_time</strong>: <code>Date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Nominal start time for the Task Plan as a whole. The timings of individual Tasks may be specified as offsets from this time, via PLANNED_TIME.relative_offset.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>RT_TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Root of run-time Task Plan Task structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>owner</strong>: <code>TASK_PLAN</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Owning Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>wait_conditions</strong>: <code>List&lt;RT_WAIT_CONDITIONS&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference list of all wait conditions in the Task Plan, and current status.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>principal_performer</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Run-time principal performer - a person or other agent.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Lifecycle state of Task Plan, derived as a copy of the lifecycle_state() of the definition TASK_GROUP.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rt_wait_conditions_class"><a class="anchor" href="#_rt_wait_conditions_class"></a>7.2.6.3. RT_WAIT_CONDITIONS Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RT_WAIT_CONDITIONS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Class representing the runtime tracked form of wait_conditions on a single TASK_ITEM.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_item</strong>: <code>RT_TASK_ITEM</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to the Task Item being tracked.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>outstanding</strong>: <code>List&lt;TASK_NOTIFICATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Outstanding wait conditions of the referenced Task item.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>satisfied</strong>: <code>TASK_NOTIFICATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Wait conditions from Task definition that have been satisfied so far by receipt of relevant notifications.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rt_plan_item_class"><a class="anchor" href="#_rt_plan_item_class"></a>7.2.6.4. RT_PLAN_ITEM Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>RT_PLAN_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of run-time types that correspond to design time PLAN_ITEM instances.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">LOCATABLE</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>participations</strong>: <code>List&lt;PARTICIPATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Run-time participations of this Plan Item in addition to principal performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>PLAN_ITEM</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Corresponding item from Task Plan definition. Redefined in descendants to the definition type corresponding to each runtime (RT_XXX) type.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rt_task_item_class"><a class="anchor" href="#_rt_task_item_class"></a>7.2.6.5. RT_TASK_ITEM Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>RT_TASK_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of run-time types that correspond to design time TASK_ITEM instances.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">RT_PLAN_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_ITEM</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding TASK_ITEM instance in Task Plan definition. Redefined in descendants.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rt_decision_group_class"><a class="anchor" href="#_rt_decision_group_class"></a>7.2.6.6. RT_DECISION_GROUP Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RT_DECISION_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Run-time homologue of DECISION_GROUP from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">RT_PLAN_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value_expression</strong>: <code>ASSIGNMENT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Runtime form of value_expression from ask Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>DECISION_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding DECISION_GROUP instance in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>paths</strong>: <code>List&lt;RT_DECISION_PATH_GROUP&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Decision path groups, computed by following definition link to the corresponding DECISION_GROUP object in Task Plan definition.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rt_task_group_class"><a class="anchor" href="#_rt_task_group_class"></a>7.2.6.7. RT_TASK_GROUP Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RT_TASK_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Run-time homologue of TASK_GROUP from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">RT_TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;RT_PLAN_ITEM&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Member run-time items in group, mimicking structure of the corresponding definition group instance.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding TASK_GROUP instance in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Effective lifecycle state, computed from the states of members of the group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rt_task_class"><a class="anchor" href="#_rt_task_class"></a>7.2.6.8. RT_TASK Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RT_TASK</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Run-time homologue of TASK type and its descendants from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">RT_TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Current lifecycle state of this Task at run-time.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>events</strong>: <code>List&lt;TASK_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of references to run-time events that have occurred on this Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preconditions</strong>: <code>List&lt;ASSERTION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Run-time form of preconditions on corresponding TASK in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding TASK instance in Task Plan definition.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_rt_decision_path_group_class"><a class="anchor" href="#_rt_decision_path_group_class"></a>7.2.6.9. RT_DECISION_PATH_GROUP Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RT_DECISION_PATH_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Run-time homologue of DECISION_PATH_GROUP from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">RT_TASK_ITEM</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>test_expression</strong>: <code>ASSERTION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Runtime form of test_expression from ask Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>DECISION_PATH_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding DECISION_PATH_GROUP instance in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Effective lifecycle state, computed from the states of members of the group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_task_plan_execution_history"><a class="anchor" href="#_task_plan_execution_history"></a>7.3. Task Plan Execution History</h3>
<div class="paragraph">
<p>The history of execution events is represented in the runtime instance of <code>EXECUTION_HISTORY</code>. This is a history of real world execution events that accumulate over the duration of processing of the Task Plan. Two types of event are used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TASK_EVENT_RECORD</code>: type representing a change to one consitutent Task. Thus, if the performer cancels a particular Task within the list, a <code>TASK_EVENT_RECORD</code> will be added to the history, including Task id, time, and reason; notifications can also be recorded on such events;</p>
</li>
<li>
<p><code>TASK_PLAN_EVENT_RECORD_</code>: type representing any kind of execution event not linked to a specific Task, for example 'plan abandonment', 'new principal performer'.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first type may also include forward references to EHR Entries that were committed as a result of a Task being performed. This facilitates logical indexing of planned and performed work items.</p>
</div>
<div class="paragraph">
<p>The Execution history will clearly grow and might become quite long for some Task Plan executions. How it may be persisted in various ways. The following possibilities are all compatible with both the model, and typical EHR requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Task Plan application persistence:</p>
<div class="ulist">
<ul>
<li>
<p>persist the full history, delete or archive once the Task Plan is fully completed;</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the EHR:</p>
<div class="ulist">
<ul>
<li>
<p>persist the full history in some or all cases, if useful in the EHR environment (e.g. for teaching);</p>
</li>
<li>
<p>persist a partial / filtered version of the history, e.g. retain only <em>cancel</em> and <em>abort</em> events, on the basis that completed Tasks will show up as <code>ACTIONs</code> elsewhere in the EHR;</p>
</li>
<li>
<p>don&#8217;t persist any of the history - rely on the workflow application persistence for it during execution, and forget afterward.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This approach cleanly separates the definitional representation of a Task Plan, which should only change if changes to the plan are made, and the execution state, which is built during the work performance.</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions_3"><a class="anchor" href="#_class_descriptions_3"></a>7.3.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_plan_execution_history_class"><a class="anchor" href="#_task_plan_execution_history_class"></a>7.3.1.1. TASK_PLAN_EXECUTION_HISTORY Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN_EXECUTION_HISTORY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>History of Task Plan execution events and notifications. May be used by a workflow application to record all events during execution.</p>
</div>
<div class="paragraph">
<p>May be persisted in the EHR in partial or complete form, or not at all.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_events</strong>: <code>List&lt;TASK_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task-level execution time events.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plan_events</strong>: <code>List&lt;TASK_PLAN_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Execution time events that occurred at the Task Plan level, i.e. not to a particular task. These include events such as Task Plan abandonment.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_event_record_class"><a class="anchor" href="#_event_record_class"></a>7.3.1.2. EVENT_RECORD Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EVENT_RECORD (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of types representing execution time events on a Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong>: <code>Date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time the event occurred.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional description associated with the event. Would typically be populated for Cancel and Abort events.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_plan_event_record_class"><a class="anchor" href="#_task_plan_event_record_class"></a>7.3.1.3. TASK_PLAN_EVENT_RECORD Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN_EVENT_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of an runtime event to a Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">EVENT_RECORD</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>details</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other details as a name/value list.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_event_record_class"><a class="anchor" href="#_task_event_record_class"></a>7.3.1.4. TASK_EVENT_RECORD Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_EVENT_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of an event for a single Task. Records task identifier, time, resulting lifecycle state and optional reason.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">EVENT_RECORD</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identification of Task in the Task Plan structre using a path of the form /task_group_id/task_group_id.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The lifecycle state that was reached due to this event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>notifications_sent</strong>: <code>List&lt;TASK_NOTIFICATION_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Notifications that were performed as part of this Task Event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entry_instances</strong>: <code>List&lt;ENTRY&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Forward references to Entry (e.g. ACTION, OBSERVATION etc) that was recorded as a result of this Task being performed. If this is set, it indicates that the planned Task is 'done' i.e. checked off the plan.</p>
</div>
<div class="paragraph tbd">
<p>ISSUE-fwd-refs: entry_instance is a forward reference - which requires updating the Task Plan after the Tasks have beed performed and relevant Entries committed. Is this complication worth the benefit obtained, i.e. directly followable links rather than querying, to find Entries from the Task Plan items? Is being able to determine the resulting Entries starting from the Task Plan even useful?</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preconditions_satisfied</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set to True if all preconditions defined on the corresponding Task were satisfied at runtime. If set to False, and there were preconditions, this means that preconditions were overridden by the user at runtime.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>wait_conditions_satisfied</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set to True if all wait_conditions for the corresponding Task were satisfied when it was performed. If False, and there were wait_conditions, wait_conditions were overridden by the user at runtime.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_notification_record_class"><a class="anchor" href="#_task_notification_record_class"></a>7.3.1.5. TASK_NOTIFICATION_RECORD Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_NOTIFICATION_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of a notification to another party (i.e. performer).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>reciever</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identification of the receiver party</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>receiver_task_plan</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of receiving Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>details</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other details as a name/value list.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cost_tracking"><a class="anchor" href="#_cost_tracking"></a>7.4. Cost Tracking</h3>
<div class="paragraph tbd">
<p>TBD: describe cost tracking.</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions_4"><a class="anchor" href="#_class_descriptions_4"></a>7.4.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_costing_class"><a class="anchor" href="#_task_costing_class"></a>7.4.1.1. TASK_COSTING Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_COSTING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Costing information for a Task.</p>
</div>
<div class="paragraph tbd">
<p>TODO: to be developed.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transactional_micro_service"><a class="anchor" href="#_transactional_micro_service"></a>7.5. Transactional Micro-service</h3>
<div class="paragraph">
<p>The information structures required to represent planned Tasks and references at runtime are likely to be non-trivial. For this reason, a Micro-service is defined, with a transactional interface that converts transactional calls to correct underlying information structures.</p>
</div>
<div class="paragraph tbd">
<p>TBC:</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions_5"><a class="anchor" href="#_class_descriptions_5"></a>7.5.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_planning_ms_interface"><a class="anchor" href="#_task_planning_ms_interface"></a>7.5.1.1. TASK_PLANNING_MS Interface</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLANNING_MS</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task planning micro-service: a service that knows how to create and maintain correct Task Planning information structures.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_task_list</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>add_task</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remove_task</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cancel_task</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>link_perfomed_action</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>etc</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relationship_with_other_openehr_ehr_artefacts"><a class="anchor" href="#_relationship_with_other_openehr_ehr_artefacts"></a>8. Relationship with other openEHR EHR Artefacts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_principles"><a class="anchor" href="#_principles"></a>8.1. Principles</h3>
<div class="paragraph">
<p>The model enables a flexible relationship between a Task Plan and orders, i.e. openEHR <code>INSTRUCTIONs</code>. In simple cases, a Task Plan will just be the list of Tasks to fulfill one order, i.e. a single <code>INSTRUCTION</code>, such as a prescription for a course of antibiotics. The general case however is that the Task Plan corresponds to a clinical goal which implicates multiple orders, for example the CHOP chemotherapy mentioned above.</p>
</div>
<div class="paragraph">
<p>It may also be the case that <em>not every Task is associated with an order</em>. While a typical case is that a Task corresponds to an openEHR <code>ACTION</code> that has not yet been recorded (and which normally has a driving <code>INSTRUCTION</code>), it may also correspond to an <code>ACTION</code> that has no <code>INSTRUCTION</code> or indeed an <code>OBSERVATION</code> or possibly an <code>EVALUATION</code> (perhaps some kind of check during a procedure). There is also no reason why a Task Plan cannot consist of Tasks that define administrative work and would be documented with openEHR <code>ADMIN_ENTRYs</code>.</p>
</div>
<div class="paragraph">
<p>We can infer from the above that the main driver of a Task Plan isn&#8217;t in general an order, but a guideline or protocol which usually includes orders. In simple cases, no formal protocol is used, and the orders (i.e. <code>INSTRUCTIONs</code>) may be <em>de facto</em> drivers, or the Task Plan may be created <em>ad hoc</em>, such an in-patient pain medication administration plan by nursing staff. At the other extreme, a Task Plan may be created with no corresponding orders (and therefore no <code>INSTRUCTIONs</code>) at all.</p>
</div>
<div class="paragraph">
<p>The following figure shows the correspondences between the various type of openEHR artefact for the general case of Task Plans. The arrows indicate causal relationships.</p>
</div>
<div id="planning_artefact_relationships" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/planning_artefacts.svg" alt="planning artefacts" width="50%">
</div>
<div class="title">Figure 15. openEHR Planning Artefact Relationships</div>
</div>
<div class="paragraph">
<p>In the above, items in yellow are driven solely by the guideline and have no corresponding order; planned items with a red cross have been cancelled and have no corresponding performed Action or Observation.</p>
</div>
<div class="paragraph">
<p>One of the side-effects of distinct state machines for <code>INSTRUCTIONs</code> and Task Plans is that not all careflow steps and states in the former need to be represented as Tasks in a Task Plan. For example, a significant number of careflow steps defined in <code>ACTION</code> archetypes are for non-Active states, i.e. Planning, Postponement, Suspension etc. These steps do not need to have Tasks defined for them, since by definition they are nearly all unplanned.</p>
</div>
<div class="paragraph">
<p>As a consequence, most Tasks in a Task Plan correspond only to Active-state careflow steps of constituent order <code>INSTRUCTIONs</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_time_ehr_structures"><a class="anchor" href="#_execution_time_ehr_structures"></a>8.2. Execution-time EHR Structures</h3>
<div class="paragraph">
<p>The model described here provides significant power when used with openEHR Instructions, Actions and Observations to represent clinical work driven by guidelines and order sets. This section describes the relationship of information instances that correspond to the various phases of work described earlier, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>ordering</em>: creation of <code>INSTRUCTIONs</code>;</p>
</li>
<li>
<p><em>task planning</em>: creation of <code>TASK_PLAN(s)</code> representing a plan of individual tasks that achieve the order intention;</p>
</li>
<li>
<p><em>execution</em>: creation of <code>ACTION</code> and other Entry types that document the Tasks as they were performed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The model supports logical linking between these items to support workflow traceability. The following figure illustrates both aspects, which are further described below.</p>
</div>
<div id="runtime_planning_structures" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/planning_runtime_structures.svg" alt="planning runtime structures" width="80%">
</div>
<div class="title">Figure 16. Runtime planning structures</div>
</div>
<div class="paragraph">
<p>Various links can be recorded at execution time, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>planned Task to Order reference</strong>: the <code>TASK_EVENT_RECORD.entry_instances</code> attribute is used to record reverse reference(s) from a <code>TASK</code> to an <code>ACTIVITY</code> within an <code>INSTRUCTION</code> that records a corresponding order, if one exists (shown on the diagram as a logical link from <code>DEFINED_TASK</code> to <code>ACTIVITY</code> instances);</p>
</li>
<li>
<p><strong>planned Task to performed Task reference</strong>: the <code>TASK_EVENT_RECORD.entry_instances</code> attribute is used to record a forward reference to the Entry instance that was created when this Task was performed, i.e. some <code>ACTION</code>, <code>OBSERVATION</code> etc (shown on the diagram as a logical link from <code>DEFINED_TASK</code> to <code>ACTION</code> instances);</p>
</li>
<li>
<p><strong>performed Task to planned Task reference</strong>: the <code>ENTRY.<em>workflow_id</em></code> attribute may be used to record a reverse reference from an <code>ACTION</code>, <code>OBSERVATION</code> etc to a causing <code>TASK</code> instance.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scenarios"><a class="anchor" href="#_scenarios"></a>9. Scenarios</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_protocol_driven_plan"><a class="anchor" href="#_protocol_driven_plan"></a>9.1. Protocol-driven Plan</h3>
<div class="paragraph tbd">
<p>This section to be rewritten.</p>
</div>
<div class="paragraph">
<p>The following UML instance diagram shows a partial state of an EHR containing orders and a related Task Plan. The upper part shows a <code>COMPOSITION</code> containing a number of <code>INSTRUCTIONs</code> that express the orders for Cyclophosphamide, Hydroxydaunorubicin (Doxorubicin), etc, that make up the order set for a CHOP chemotherapy protocol (to be more complete, Rituximab would also be included). It is assumed that the orders contain the correct dosages for the patient, i.e. that they have been calculated in advance for the patient&#8217;s body weight, surface area and other specifics. A few elements of an <code>ACTIVITY</code> for the Cyclophosphamide drug are shown here.</p>
</div>
<div class="paragraph">
<p>In the lower part of the part of the diagram is a <code>COMPOSITION</code> containing a <code>TASK_PLAN</code> structure representing the list of work items to perform in order to administer the chemotherapy to the patient. It is assumed that a specialised chemotherapy application has been used to created this structure. The first <code>DEFINED_TASK</code> is shown in some detail, and includes a reference back to the related Instruction Activity, enabling an application to retrieve and display the details of the order. As a precaution, it also has the <code><em>description</em></code> attribute set to the value <code>"Cyclophosphamide 1400 mg IV"</code>, copied (or generated) from the <code>INSTRUCTION</code> when the <code>TASK_PLAN</code> was created. The other attributes of the <code>DEFINED_TASK</code> object indicate when to execute the Task, what professional role should do it (<code><em>participations</em></code>), the Careflow step ('administer') and the target state machine state (<code>active</code>).</p>
</div>
<div class="paragraph">
<p>Each of the <code>DEFINED_TASK</code> protype instances in the <code>TASK_PLAN</code> should logically speaking be almost a copy of the <code>ACTION</code> that would result from performing the Task. This is not literally true, since there are fields representing various kinds of links, identifiers and other protocol and care plan information, but for the core information of what to do, and when to do it the instance data for a Planned action should be a tight constraint version of the intended Action to result.</p>
</div>
<div id="planning_typical_instance" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/Planning-typical-instance.svg" alt="Planning typical instance">
</div>
<div class="title">Figure 17. Typical Task Plan - CHOP Chemotherapy</div>
</div>
<div class="paragraph">
<p>It is worth considering some of the differences between how an order represents the Task and how it may be represented in a <code>DEFINED_TASK</code> and an eventual <code>ACTION</code>. Consider the fourth drug in the CHOP regimen, a choice of Prednisone or Prednisolone. In the form expressed in the order, i.e. the <code>INSTRUCTION</code>, it may be expressed in the following form:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>administer 80mg orally every day for 5 days</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This could be expressed as a single <code>ACTIVITY</code> with the <code>INSTRUCTION.<em>timing</em></code> attribute set to represent 'once a day for 5 days'.</p>
</div>
<div class="paragraph">
<p>In the <code>TASK_PLAN</code> however, it will be expressed as 5 separate <code>DEFINED_TASK</code> instances, each with an associated prototype <code>ACTION</code> instance. Each of these indicates a single dose for one day. This corresponds to how the drug is actually administered and enables the system (and openEHR data) to represent each action individually, as well as deviations such as not performing one or more of the administrations. The information displayed representing each Task to the human agent will therefore be somewhat different to the form in which it is expressed in the generating order.</p>
</div>
<div class="paragraph">
<p>However, the order <code>INSTRUCTION</code> could have been created using a series of 5 <code>ACTIVITY</code> objects each representing a single day&#8217;s administration. In this case, the form defined in each <code>ACTIVITY</code> is very close to the form required to represent each Task in the Task Plan.</p>
</div>
<div class="paragraph">
<p>It is assumed that determining how to populate the details of the <code>DEFINED_TASK</code> is up to an intelligent application that knows the relationship between the relevant orders or order sets, and the exact form of Task Plans to implement them.</p>
</div>
</div>
<div class="sect2">
<h3 id="_check_list_and_sign_off"><a class="anchor" href="#_check_list_and_sign_off"></a>9.2. Check-list and Sign-off</h3>
<div class="paragraph tbd">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_changes_during_execution"><a class="anchor" href="#_changes_during_execution"></a>9.3. Changes during Execution</h3>
<div class="paragraph tbd">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_abandonment"><a class="anchor" href="#_abandonment"></a>9.4. Abandonment</h3>
<div class="paragraph tbd">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_guidance"><a class="anchor" href="#_implementation_guidance"></a>10. Implementation Guidance</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_workflow_application_design"><a class="anchor" href="#_workflow_application_design"></a>10.1. Workflow Application Design</h3>
<div class="paragraph">
<p>TODO:</p>
</div>
</div>
<div class="sect2">
<h3 id="_versioning"><a class="anchor" href="#_versioning"></a>10.2. Versioning</h3>
<div class="paragraph">
<p>The information structures described in this specification may in some cases become non-trivial in size and complexity, and some attention as to when changing states of a Task Plan are committed to the EHR is likely to be needed. When a Task Plan is first instantiated, it may be committed to the EHR in order to act as a shared, visible statement of outstanding work, particularly work to be done by teams and/or across shift boundaries. When the work is underway, although it would be possible to commit changes due to changing lifecycle states of each Task, it may be preferable to allow these changes to be tracked only by the workflow application and for the Task Plan to only be recommitted once completed or abandoned, or possibly at strategic points in time prior to this, for example nursing shift changes.</p>
</div>
<div class="paragraph">
<p>It does not appear likely that any single rule for when to commit the changed state of a Task Plan to the EHR can be established for all possible situations, but it is recommended that the commit points are chosen carefully so that their meaning is clear.</p>
</div>
<div class="paragraph">
<p>Interim commits of a Task Plan to a persistent store for workflow management or some other application may of course be useful.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_publications"><a class="anchor" href="#_publications"></a>Publications</h3>
<div class="olist bibliography">
<ol class="bibliography">
<li>
<p><a id="van_der_Aalst_2005a"></a>[van_der_Aalst_2005a] Van der Aalst, Weske, Grunbauer. <strong>Case Handling: A New Paradigm for Business Process Support.</strong> Data and Knowledge Engineering, 53(2):129-162, 2005.</p>
</li>
<li>
<p><a id="van_der_Aalst_2013a"></a>[van_der_Aalst_2013a] Wil van der Aalst. <strong>Business Process Management: A Comprehensive Survey.</strong> ISRN Software Engineering, pages 1-37, 2013. doi:10.1155/2013/507984.</p>
</li>
<li>
<p><a id="Baretto_2005"></a>[Baretto_2005] Barretto S A. <strong>Designing Guideline-based Workflow-Integrated Electronic Health Records.</strong> 2005. PhD dissertation, University of South Australia. Available at <a href="http://www.cis.unisa.edu.au/~cissab/Barretto_PhD_Thesis_Revised_FINAL.pdf" class="bare">http://www.cis.unisa.edu.au/~cissab/Barretto_PhD_Thesis_Revised_FINAL.pdf</a>.</p>
</li>
<li>
<p><a id="Beale_2000"></a>[Beale_2000] Beale T. <strong>Archetypes: Constraint-based Domain Models for Future-proof Information Systems.</strong> 2000.  Available at <a href="http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_web_2000.pdf" class="bare">http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_web_2000.pdf</a> .</p>
</li>
<li>
<p><a id="Beale_2002"></a>[Beale_2002] Beale T. <strong>Archetypes: Constraint-based Domain Models for Future-proof Information Systems.</strong> Eleventh OOPSLA Workshop on Behavioral Semantics: Serving the Customer (Seattle, Washington, USA, November 4, 2002). Edited by Kenneth Baclawski and Haim Kilov. Northeastern University, Boston, 2002, pp. 16-32. Available at <a href="http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_oopsla_2002.pdf" class="bare">http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_oopsla_2002.pdf</a> .</p>
</li>
<li>
<p><a id="BPTrends_2009"></a>[BPTrends_2009] <strong>Case Management: Combining Knowledge With Process.</strong> White paper in BPTrends July 2009.</p>
</li>
<li>
<p><a id="Browne_2005"></a>[Browne_2005] Eric Browne. <strong>Workflow Modelling of Coordinated Inter-Health-Provider Care Plans.</strong> PhD thesis submitted to the School of Computer and Information Science, University of South Australia. January 2005.</p>
</li>
<li>
<p><a id="GLIF"></a>[GLIF] Lucila Ohno-Machado, John H. Gennari, Shawn N. Murphy, Nilesh L. Jain, Samson W. Tu, Diane E. Oliver, Edward Pattison-Gordon, Robert A. Greenes, Edward H. Shortliffe, and G. Octo Barnett.  <strong>The GuideLine Interchange Format - A Model for Representing Guidelines</strong>. J Am Med Inform Assoc. 1998 Jul-Aug; 5(4): 357–372.</p>
</li>
<li>
<p><a id="Hull_et_al_2010a"></a>[Hull_et_al_2010a] Richard Hull et al. <strong>Introducing the Guard-Stage-Milestone Approach for Specifying Business Entity Lifecycles.</strong> Preprint from Proc. Intl. Workshop on Web Services and Formal Methods (WS-FM), 2010. To appear in Springer-VerlagLNCS 6551.</p>
</li>
<li>
<p><a id="Mulyar_et_al_2007"></a>[Mulyar_et_al_2007]  Nataliya Mulyar, Maja Pesic, Wil M.P. van der Aalst and Mor Peleg. <strong>Declarative and Procedural Approaches for Modelling Clinical Guidelines: Addressing Flexibility Issues.</strong> Conference: Business Process Management Workshops, BPM 2007 International Workshops, BPI, BPD, CBP, ProHealth, RefMod, semantics4ws, Brisbane, Australia, September 24, 2007.</p>
</li>
<li>
<p><a id="Mulyar_et_al_2008"></a>[Mulyar_et_al_2008] Nataliya Mulyar, Maja Pesic, Wil M.P. van der Aalst and Mor Peleg. <strong>Towards the Flexibility in Clinical Guideline Modelling Languages.</strong></p>
</li>
<li>
<p><a id="Hofstede_van_der_Aalst_2009"></a>[Hofstede_van_der_Aalst_2009] Hofstede, van der Aalst et al. <strong>Modern Business Process Automation: YAWL and its Support Environment.</strong> Springer 2009.</p>
</li>
<li>
<p><a id="Mei_et_al_2014"></a>[Mei_et_al_2014] Jing MEI, Jing LI, Yiqin YU, Xiang LI, Haifeng LIU and Guotong XIE. <strong>Embracing case management for computerization of care pathways.</strong> e-Health – For Continuity of Care C. Lovis et al. (Eds.) 2014 European Federation for Medical Informatics and IOS Press. doi:10.3233/978-1-61499-432-9-3</p>
</li>
<li>
<p><a id="Müller_2003"></a>[Müller_2003] Robert Müller. <strong>Event-Oriented Dynamic Adaptation of Workflows: Model, Architecture, and Implementation.</strong> PhD thesis submitted to Fakultät für Mathematik und Informatik at the Universität Leipzig, 2003.</p>
</li>
<li>
<p><a id="Pescosolido"></a>[Pescosolido] Bernice A. Pescosolido, Indiana University, USA. <strong>Patient trajectories.</strong> <a href="http://onlinelibrary.wiley.com/doi/10.1002/9781118410868.wbehibs282/pdf">Wiley Online Library</a></p>
</li>
<li>
<p><a id="Russell_et_al_2007"></a>[Russell_et_al_2007]  N. Russell, A.H.M. ter Hofstede, and W.M.P. van der Aalst. <strong>newYAWL: Specifying a Workflow Reference Language using Coloured Petri Nets.</strong> In K. Jensen, editor, Proceedings of the Eighth Workshop on the Practical Use of Coloured Petri Nets and CPN Tools (CPN 2007), volume 584 of DAIMI, pages 107-126, Aarhus, Denmark, October 2007. University of Aarhus.</p>
</li>
<li>
<p><a id="Schrijvers_et_al_2012"></a>[Schrijvers_et_al_2012] Guus Schrijvers, Arjan van Hoorn, Nicolette Huiskes. <strong>The Care Pathway Concept: concepts and theories: an introduction.</strong> International Journal of Integrated Care. 2012;12(6). DOI: <a href="http://doi.org/10.5334/ijic.812" class="bare">http://doi.org/10.5334/ijic.812</a></p>
</li>
<li>
<p><a id="Vanhaecht_et_al_2007"></a>[Vanhaecht_et_al_2007] Vanhaecht K, De Witte K, Sermeus W. <strong>The impact of clinical pathways on the organisation of care processes.</strong> PhD dissertation, Belgium: KU Leuven; 2007.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-06-12 11:55:04 BST
</div>
</div>
</body>
</html>